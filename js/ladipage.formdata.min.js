LadiPageScriptV2.prototype.sendFormCheckout=function(t,e){var i=this,a=(t=i.findAncestor(t,"ladi-element")).getAttribute("data-payment");a=JSON.parse(a);var n=Array.from(t.querySelectorAll('[data-form-checkout-item="product"] .ladi-form-checkout-payment-check.checked')).map(function(t){var e=i.findAncestor(t,"ladi-form-checkout-box"),a=JSON.parse(e.getAttribute("data-product"));a.quantity=1;var n=e.querySelector(".ladi-form-checkout-payment-quantity input");return isEmptyLadiPage(n)||(a.quantity=parseInt(n.value)||a.quantity),a}),o=isObjectLadiPage(i.runtime.payment_setting)?i.runtime.payment_setting:{},r=e.setFormData(t,!1),c=r.formDataObject,d=((r=e.setFormDataObjectThankyou()).formDataObjectThankyou,r.formDataObjectConvertThankyou),s=isEmptyLadiPage(c.name)?"":c.name,u=isEmptyLadiPage(c.email)?"":c.email,l=isEmptyLadiPage(c.phone)?"":c.phone,p=isEmptyLadiPage(c.country)?"":c.country.split(":")[0],m=isEmptyLadiPage(c.state)?"":c.state.split(":")[0],_=isEmptyLadiPage(c.ward)?"":c.ward.split(":")[0],g=isEmptyLadiPage(c.district)?"":c.district.split(":")[0],f=isEmptyLadiPage(c.address)?"":c.address.split(":")[0],h=!1,y=!1,v=!1,E=!0,L=0,P=function(t,e){return t},w=function(a){var n=o.thankyou_type,r=o.thankyou_value,c=!1;i.runtime.has_popupx&&i.runtime.tmp.popupx_is_inline&&(c=!0);var s=i.runtime.eventData[t.id]["option.form_auto_funnel"],u="";n==i.const.FORM_THANKYOU_TYPE.default&&(isEmptyLadiPage(r)||i.showMessage(r,d)),n==i.const.FORM_THANKYOU_TYPE.popup&&(s&&i.setDataReplaceElement(!1,!1,d,r),window.ladi(r).show(!1,{formThankyouPopupXInline:c})),n!=i.const.FORM_THANKYOU_TYPE.url&&n!=i.const.FORM_THANKYOU_TYPE.url_default||isEmptyLadiPage(a)||(r=window.ladi(a).encode_thankyou_url(),u=P(r),i.runTimeout(function(){window.ladi(u).open_url()},0)),e.resetFormValue(t.querySelector(".ladi-form"))},k=function(t,e){"Success"==t&&w(e.thanks_url),"Canceled"==t&&i.showMessage(i.const.LANG.FORM_CHECKOUT_ORDER_CANCEL)};window.formCheckoutDownloadQRCode=function(){const t=document.getElementById("form-checkout-bank-qr").src;fetch(t).then(t=>t.blob()).then(t=>{const e=new FileReader;e.onloadend=function(){const t=e.result,i=document.createElement("a");i.href=t,i.download="qr_code.png",document.body.appendChild(i),i.click(),document.body.removeChild(i)},e.readAsDataURL(t)}).catch(t=>console.error("Error downloading image:",t))},window.formCheckoutCopyToClipboard=function(t){const e=t.closest(".info-row"),i=e?e.querySelector(".info-value"):null;if(i){const e=i.textContent.trim(),a=document.createElement("input");a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a),a.value=e,a.select(),document.execCommand("copy"),document.body.removeChild(a);const n=t.querySelector(".tooltiptext.right"),o=n.getAttribute("tooltiptext");n.setAttribute("tooltiptext","Copied to clipboard!"),n.style.visibility="visible",n.style.opacity="1",setTimeout(()=>{n.setAttribute("tooltiptext",o),n.style.visibility="hidden",n.style.opacity="0"},2e3)}else console.error("The .info-value element was not found.")},window.formCheckoutClosePopupQRCode=function(){h=!0;var t=document.querySelector(".ladipage-message");t&&t.remove();var e=document.querySelector("body .ladi-wraper");e&&(e.style.display="block"),i.removeTimeout(L),L=null},window.clickConfirmBankedCheckout=function(){console.log(111)};var b=function(t){h=!1;var e="form-checkout-bank-qr",a=t.bank_info.banks[0].autoConfirmPayment;const n=document.querySelector("body .ladi-wraper"),o=window.innerWidth<=768;if(n&&o?n.style.display="none":n&&(n.style.display=""),isEmptyLadiPage(document.getElementById(e))){LadiPageScript.showMessage(`\n            <style>\n                .ladipage-message-box {\n                    font-family: "Roboto", sans-serif;\n                    border-radius: 0 !important;\n                    width: 100% !important;\n                    max-width: 100% !important;\n                    height: 100% !important;\n                    top: 0 !important;\n                    left: 0 !important;\n                    background: transparent !important;\n                    display: flex !important;\n                    justify-content: center;\n                    align-items: center;\n                }\n                .ladipage-message-box > span {\n                   display: none !important;\n                }\n                .ladipage-message-text {\n                    display: block !important;\n                    width: fit-content;\n                    height: fit-content;\n                    margin-top: 0 !important;\n                    padding: 24px !important;\n                    background: #fff;\n                    border-radius: 8px;\n                    position: relative;\n                }\n                .cursor {\n                    cursor: pointer;\n                }\n                .ladipage-message-text .ladipage-message-title {\n                    display: flex;\n                    justify-content: center;\n                    align-items: center;\n                    flex-direction: column;\n                    row-gap: 8px;\n                }\n                .ladipage-message-text .text-title {\n                    color: #3B3B44;\n                    font-weight: 600;\n                    font-size: 18px;\n                }\n                .ladipage-message-text .text-sub-title {\n                    font-weight: 400;\n                    font-size: 14px;\n                    color: #3C72F9;\n                }\n                .ladipage-message-text .sub-title {\n                    display: flex;\n                    align-items: center;\n                    gap: 8px;\n                }\n                .ladipage-message-title .count-down {\n                    display: flex;\n                    gap: 8px;\n                }\n\n                .ladipage-message-title .close-popup {\n                    color: #8A3FFC;\n                }\n                .ladipage-message-text .ladipage-message-content {\n                    display: flex;\n                    gap: 16px;\n                    padding-top: 12px;\n                }\n                .ladipage-message-text .form-qr-code {\n                    display: flex;\n                    flex-direction: column;\n                    align-items: center;\n                    row-gap: 12px;\n                    max-width: 300px;\n                }\n\n                .ladipage-message-text .form-qr-code .text-qr-code {\n                    color: #3B3B44;\n                    font-weight: 600;\n                    font-size: 14px;\n                }\n\n                .ladipage-message-content .download-qr-code {\n                    display: flex;\n                    gap: 4px;\n                }\n                .ladipage-message-content .download-qr-code img {\n                    filter: invert(6%) sepia(40%) saturate(5000%) hue-rotate(242deg) brightness(89%) contrast(90%);\n                }\n                .ladipage-message-content .form-qr-code .qr-text-document {\n                    color: #566577;\n                    font-size: 14px;\n                    font-weight: 400;\n                    text-align: center;\n                }\n                .ladipage-message-content .form-qr-code .qr-text-document span {\n                    font-size: 14px;\n                    color: #566577;\n                }\n                .ladipage-message-text .form-qr-code .text-download-qr {\n                    color: #7C4AF2;\n                    font-size: 12px;\n                }\n\n                .ladipage-message-content .form-bank-content {\n                    display: flex;\n                    flex-direction: column;\n                    align-items: center;\n                    row-gap: 14px;\n                    max-width: 396px;\n                }\n\n                .ladipage-message-content .form-bank-content .title {\n                    color: #3B3B44;\n                    font-weight: 400;\n                    font-size: 14px;\n                }\n                .ladipage-message-content .form-bank-content .title span {\n                    font-weight: 600;\n                    color: #3B3B44;\n                    font-size: 14px;\n                }\n                \n                .ladipage-message-text span { \n                    text-align: center;\n                    display: inline !important;\n                    background-color: transparent !important;\n                    padding: 0 !important;\n                    margin-top: 10px;\n                }\n                .text-not-config {\n                    font-size: 14px;\n                    color: #3B3B44;\n                    text-align: center;\n                    max-width: 632px;\n                }\n                \n                .transfer-container {\n                    border: 1px solid #e0e0e0;\n                    border-radius: 8px;\n                    padding: 0 12px 12px;\n                    background-color: #fff;\n                    min-width: 396px;\n                }\n                .transfer-container .logo-bank {\n                    display: flex;\n                    justify-content: center;\n                    align-items: center;\n                }\n                .transfer-header {\n                    text-align: center;\n                    font-size: 16px;\n                    font-weight: 600;\n                    margin-bottom: 20px;\n                }\n                .info-row {\n                    display: flex;\n                    justify-content: start;\n                    align-items: center;\n                    padding: 8px 0;\n                    border-bottom: 1px solid #F1F1F1;\n                }\n                .info-row:last-child {\n                    border-bottom: none;\n                }\n                .info-label {\n                    color: #64768D;\n                    font-size: 14px;\n                    font-weight: 400;\n                    min-width: 80px;\n                }\n                .info-value {\n                    color: #3B3B44;\n                    font-weight: 600;\n                    font-size: 14px;\n                    margin-left: 24px;\n                }\n                .note {\n                    background-color: #FFF3D0;\n                    padding: 12px;\n                    border-radius: 4px;\n                    margin-top: 12px;\n                    font-size: 14px;\n                    font-weight: 400;\n                    color: #000000;\n                }\n                .note span {\n                    color: #000;\n                    font-weight: 600;\n                }\n                .copy-button {\n                    margin-left: 10px;\n                    background-color: #F1F1F1;\n                    width: 28px;\n                    display: flex;\n                    justify-content: center;\n                    border-radius: 4px;\n                    padding: 2px;\n                    position: relative;\n                }\n                \n                .tooltiptext.right {\n                    visibility: hidden;\n                    border-radius: 2px;\n                    padding: 5px 0;\n                    position: absolute;\n                    z-index: 900000090;\n                    width: 100%;\n                    height: 100%;\n                    top: 0;\n                    left: 0;\n                    pointer-events: none;\n                    line-height: 20px;\n                    opacity: 0;\n                    transition: opacity 1s;\n                }\n                .tooltiptext {\n                    font-size: 14px;\n                }\n                .tooltiptext.right::before {\n                    content: attr(tooltiptext);\n                    position: absolute;\n                    right: -6px;\n                    top: -6px;\n                    background: #0E233C;\n                    color: #fff;\n                    padding: 5px 10px;\n                    min-width: 20px;\n                    max-width: 200px;\n                    margin: auto;\n                    width: max-content;\n                    text-align: center;\n                    transform: translateX(100%) translateY(0%);\n                    word-break: break-all;\n                    border-radius: 6px;\n                }\n                .tooltiptext.right::after {\n                    content: "";\n                    position: absolute;\n                    top: 4px;\n                    right: -7px;\n                    border-width: 6px;\n                    border-style: solid;\n                    border-color: transparent black transparent transparent;\n                }\n\n                .copy-button:hover .tooltiptext.right {\n                    visibility: visible !important;\n                    opacity: 1 !important;\n                }\n                .ldicon-circle-close-fill {\n                    width: 18px;\n                    height: 18px;\n                    cursor: pointer;\n                    pointer-events: unset !important;\n                    background-color: #566577;\n                    mask-image: url(https://w.ladicdn.com/ladiui/icons/new-ldicon-close-fill-2.svg);\n                    mask-size: contain;\n                    mask-repeat: no-repeat;\n                    mask-position: center;\n                    position: absolute;\n                    top: 2%;\n                    right: 3%;\n                }\n                .ladipage-message-close {\n                    display: none !important;\n                }\n                \n                .btn-confirm {\n                    background-color: #1C00C2;\n                    color: #fff;\n                    padding: 8px 12px;\n                    border-radius: 4px;\n                    cursor: pointer;\n                }\n\n                @media only screen and (max-width: 768px) {\n                    .ladipage-message {\n                        height: auto;\n                        position: absolute;\n                    }\n                    .ladipage-message-text {\n                        margin: auto;\n                    }\n\n                    .ladipage-message .ladipage-message-box {\n                        position: absolute !important;\n                        border: none;\n                    }\n                    .ladipage-message-text .ladipage-message-content {\n                        flex-direction: column-reverse;\n                        justify-content: center;\n                        align-items: center;\n                    }\n                }\n            </style>\n            <div class="ladipage-message-title">\n                    <i onclick="formCheckoutClosePopupQRCode()" class="close-popup ladiui icon close ldicon-circle-close-fill"></i>\n                    <div class="text-title">Thanh toán chuyển khoản ngân hàng</div>\n                    ${a?'\n                        <div class="sub-title">\n                            <div class="text-sub-title">Đang chờ thanh toán</div>\n                            <div class="count-down">\n                                <div id="countdown-timer"></div>\n                            </div>\n                            <img src="https://w.ladicdn.com/ladiui/icons/ldicon-loading2.svg" width="20" height="20" alt="Loading" />\n                        </div>\n\n                        <div id="countdown-message" style="display: none;">\n                            Có vẻ như tiến trình xác nhận thanh toán tự động diễn ra lâu hơn bình thường hoặc phát sinh sự cố ngoài ý muốn. Bạn có thể liên hệ người bán để được hỗ trợ thông tin.\n                        </div>\n\n                    ':""}\n                    ${function(){const e=t.bank_info.payment_guide.replace(/\n/g,"<br>");return htmlContent='<div id="payment-guide">'+e+"</div>"}()}\n            </div>\n\n            <div class="ladipage-message-content">\n                <div class="form-qr-code">\n                            <div class="text-qr-code">Quét mã QR thanh toán</div>\n                            <img id="${e}" src="${t.bank_info.qr_url}" width="212" height="212">\n                            <div class="download-qr-code cursor" onclick="formCheckoutDownloadQRCode()">\n                                <div class="text-download-qr">Tải xuống mã QR</div>\n                                <img width="14" height="14" src="https://w.ladicdn.com/ladiui/icons/ldicon-download.svg" />\n                            </div>\n                            <div class="qr-text-document">Mở app ngân hàng hoặc ví điện tử của bạn sau đó chọn <span>quét mã QR</span> để thực hiện thanh toán.</div>\n                </div>\n                ${function(){try{return`\n                        <div class="form-bank-content">\n                        <div class="title">\n                            <span>Chuyển khoản thủ công</span> theo thông tin\n                        </div>\n                        \n                        <div class="transfer-container">\n                            <div class="tranfer-content-detail">\n                                <div class="logo-bank">\n                                    <img src="${t.bank_info.banks[0].bank.logo}" width="128" height="48" />\n\n                                </div>\n                                <div class="info-row">\n                                    <div class="info-label">Ngân hàng</div>\n                                    <div class="info-value">${t.bank_info.banks[0].bank.shortName}</div>\n                                </div>\n                                <div class="info-row">\n                                    <div class="info-label">Thụ hưởng</div>\n                                    <div class="info-value">${t.bank_info.banks[0].accountName}</div>\n                                </div>\n                                <div class="info-row">\n                                    <div class="info-label">Số tài khoản</div>\n                                    <div class="info-value">${t.bank_info.banks[0].accountNumber}</div>\n                                    <div class="copy-button cursor" onclick="formCheckoutCopyToClipboard(this)">\n                                        <img src="https://w.ladicdn.com/ladiui/icons/ldicon-copy.svg" width="16" height="16" alt="Copy" />\n                                        <div class="tooltiptext right" tooltiptext="Copy"></div>\n                                    </div>\n                                </div>\n                                <div class="info-row">\n                                    <div class="info-label">Số tiền</div>\n                                    <div class="info-value">${i.formatCurrency(t.bank_info.amount,t.bank_info.currency_symbol,!0)}</div>\n                                    <div class="copy-button cursor" onclick="formCheckoutCopyToClipboard(this)">\n                                        <img src="https://w.ladicdn.com/ladiui/icons/ldicon-copy.svg" width="16" height="16" alt="Copy" />\n                                        <div class="tooltiptext right" tooltiptext="Copy"></div>\n                                    </div>\n                                </div>\n                                <div class="info-row">\n                                    <div class="info-label">Nội dung CK</div>\n                                    <div class="info-value">${t.bank_info.banks[0].transferContentPrefix}${t.bank_info.reference_no}</div>\n                                    <div class="copy-button cursor" onclick="formCheckoutCopyToClipboard(this)">\n                                        <img src="https://w.ladicdn.com/ladiui/icons/ldicon-copy.svg" width="16" height="16" alt="Copy" />\n                                        <div class="tooltiptext right" tooltiptext="Copy"></div>\n                                    </div>\n                                </div>\n                                ${a?`\n                                    <div class="note">\n                                        Lưu ý: Vui lòng giữ nguyên nội dung <span>${t.bank_info.banks[0].transferContentPrefix}${t.bank_info.reference_no}</span> để xác nhận thanh toán tự động\n                                    </div>\n                                    `:""}\n    \n                            </div>\n                        </div>\n                        \n                    </div>\n                    `}catch(t){return""}}()}\n            </div>\n        `)}!y&&a&&(!function(t){const e=document.querySelector(".count-down"),a=document.getElementById("countdown-timer"),n=document.getElementById("countdown-message"),o=document.querySelector(".close-popup"),r=document.querySelector(".sub-title");let c=Date.now()+60*t*1e3;a.style.display="block",n.style.display="none",o.style.display="block",function t(){const d=Math.max(0,c-Date.now()),s=Math.floor(d/6e4),u=Math.floor(d%6e4/1e3);a.textContent=`${String(s).padStart(2,"0")} phút ${String(u).padStart(2,"0")} giây`,d>0?L=i.runTimeout(t,1e3):(n.style.textAlign="center",n.style.display="block",n.style.color="#E01A1A",n.style.maxWidth="632px",o.style.display="block",e.style.display="none",r.style.display="none",v=!0)}()}(5),y=!0);var r=new XMLHttpRequest;r.open("POST",i.const.API_LADISALE_CHECKOUT_GET_ORDER_STATUS),r.addEventListener("readystatechange",function(){if(4===this.readyState)try{var e=JSON.parse(this.responseText);if(200!=e.code)throw new TypeError("api error");if("Pending"==e.data.payment_status||"OnHold"==e.data.payment_status)throw new TypeError("fetch api");k(e.data.payment_status,t)}catch(e){setTimeout(function(){!h&&b(t)},1e4)}}),r.setRequestHeader("content-type","application/json"),!E||h||v||(E=a,r.send(JSON.stringify({ls_data:t.ls_data})))},A="";o.thankyou_type==i.const.FORM_THANKYOU_TYPE.url&&(A=P(o.thankyou_value)),isEmptyLadiPage(i.runtime.tmp.form_checkout_order_id)&&(i.runtime.tmp.form_checkout_order_id=i.randomString(10)),i.showLoadingBlur();var O=localStorage.getItem("previousSubmission");previousSubmission=O?JSON.parse(O):{customer_name:null,customer_email:null,customer_phone:null,variants:[],data_payment:{code:null,type:null,bank_code:null}};var T,S,x,N=n.map(function(t){return{product_id:t.product_id,product_variant_id:t.product_variant_id,quantity:t.quantity,store_id:t.store_id_product}});try{var C={code:a.code||null,method_name:a.method_name||null},D=previousSubmission.variants.length!==N.length;if(!D)for(var R=0;R<N.length;R++)!previousSubmission.variants[R]||previousSubmission.variants[R].product_id===N[R].product_id&&previousSubmission.variants[R].product_variant_id===N[R].product_variant_id&&previousSubmission.variants[R].quantity===N[R].quantity||(D=!0);var F=function(t){var e={type:null,bank_code:null};for(var i in t)t.hasOwnProperty(i)&&"object"==typeof t[i]&&null!==t[i]&&("type"in t[i]&&(e.type=t[i].type),"bank_code"in t[i]&&(e.bank_code=t[i].bank_code));return e}(a);C.type=F.type,C.bank_code=F.bank_code;var q=previousSubmission.customer_name!==s||previousSubmission.customer_email!==u||previousSubmission.customer_phone!==l,I=previousSubmission.data_payment.code!==C.code||previousSubmission.data_payment.type!==C.type||previousSubmission.data_payment.bank_code!==C.bank_code;D&&(q=!0);var M=q;!q&&I&&(M=!1);var j=JSON.stringify({tracking_script:(T=[],S="ladi_run_tracking_"+i.randomString(10),x=`window.${S} = function (data) {\n                    try {\n                        new Function(data.str)();\n                        console.log(data.str);\n                    } catch (e) {\n                        setTimeout(function () {\n                            window.${S}(data);\n                        }, 100);\n                    }\n                };`,T.push(x),isArrayLadiPage(i.runtime.tmp.form_checkout_tracking_script)&&i.runtime.tmp.form_checkout_tracking_script.forEach(function(t){T.push(`window.${S}(${JSON.stringify({str:t})});`)}),1==T.length&&(T=[]),T.join("")),tracking_conversion_api:i.runtime.tmp.form_checkout_tracking_conversion_api||[],thank_url:A,source_from:"LP",invoiceInfo:{isEnable:!1},url:window.location.href,gateway:a,product_one_page:!0,lang:"vi",domain:window.location.hostname,path:window.location.pathname.substring("/".length),path_type:"product",cart_token:!M&&window.ladi("CART_TOKEN_FORM_CHECKOUT").get_cookie(),checkout_token:!M&&window.ladi("CHECKOUT_TOKEN_FORM_CHECKOUT").get_cookie(),customer_first_name:s,customer_email:u,customer_phone:l,is_export_invoice:!1,variants:N,utm:{url_pathname:window.location.pathname,url_search:window.location.search,url_page:window.location.href},custom_fields_checkout:[],customer_country_code:p,customer_state_id:m,customer_district_id:g,customer_ward_id:_,customer_address:f,shipping_country_code:p,shipping_state_id:m,shipping_district_id:g,shipping_ward_id:_,shipping_address:f}),U=new XMLHttpRequest;U.addEventListener("readystatechange",function(){4===this.readyState&&(!function(t){try{var e=JSON.parse(t);if(200!=e.code||!isObjectLadiPage(e.data))return i.showMessage(e.message);if(e.data,!isEmptyLadiPage(e.data.redirect_url))return void(window.location.href=e.data.redirect_url);if(isObjectLadiPage(e.data.bank_info)&&!isEmptyLadiPage(e.data.bank_info.qr_url)&&!isEmptyLadiPage(e.data.ls_data)&&!h)return window.ladi("CART_TOKEN_FORM_CHECKOUT").set_cookie(e.data.cart_token,43200),window.ladi("CHECKOUT_TOKEN_FORM_CHECKOUT").set_cookie(e.data.checkout_token,43200),void(0!==e.data.bank_info.amount?b(e.data):w(e.data.thanks_url));w(e.data.thanks_url)}catch(t){return i.showMessage(i.const.LANG.REQUEST_SEND_ERROR)}}(this.responseText),i.hideLoadingBlur())}),U.open("POST",i.const.API_LADISALE_CHECKOUT_PAYMENT),U.setRequestHeader("Content-Type","application/json"),U.send(j),previousSubmission={customer_name:s,customer_email:u,customer_phone:l,variants:N,data_payment:C},localStorage.setItem("previousSubmission",JSON.stringify(previousSubmission))}catch(t){i.hideLoadingBlur()}},LadiPageScriptV2.prototype.eventFormCheckoutSelectPaymentType=function(t){var e=this;e instanceof LadiPageScriptV2||(e=LadiPageScript),t.stopPropagation();var i=e.findAncestor(t.target,"ladi-form-checkout-box"),a=e.findAncestor(t.target,["ladi-form","ladi-element"]);e.showMessage("\n    <style>\n        .ladipage-message {\n            background: transparent !important;\n        }\n        .ladipage-message-box {\n            border-radius: 0 !important;\n            width: 100% !important;\n            max-width: 100% !important;\n            height: 100% !important;\n            top: 0 !important;\n            left: 0 !important;\n            background: transparent !important;\n            border: none !important;\n        }\n        .ladipage-message-box > span {\n           display: none !important;\n        }\n        .ladipage-message-text {\n            height: 100%;\n            margin-top: 0 !important;\n            padding: 0 !important;\n        }\n        .ladipage-message .ladipage-message-box iframe {\n            width: 100%;\n            height: 100%;\n        }\n        .ladipage-message-close {\n            display: none !important;\n        }\n    </style>\n    <iframe></iframe>\n    ");var n=function(){document.querySelector(".ladipage-message-close").click()},o=function(t){var e=a.querySelector('.ladi-element[data-form-checkout-item="payment"] .ladi-form-checkout-box[data-payment-code="'+t.code+'"] .ladi-form-checkout-payment-content span:last-child');e.hasAttribute("data-old")||e.setAttribute("data-old",e.textContent),isEmptyLadiPage(t.code)?e.textContent=e.getAttribute("data-old"):e.textContent=t.method_title||e.getAttribute("data-old"),isEmptyLadiPage(t.code)||(Array.from(a.querySelectorAll('[data-form-checkout-item="payment"] .ladi-form-checkout-payment-check.checked')).forEach(function(t){t.classList.remove("checked")}),Array.from(a.querySelectorAll('[data-form-checkout-item="payment"] [data-payment-code="'+t.code+'"] .ladi-form-checkout-payment-check')).forEach(function(t){t.classList.add("checked")})),a.setAttribute("data-payment",JSON.stringify(t)),n()},r=document.querySelector(".ladipage-message-text iframe"),c=function(){var t=isObjectLadiPage(e.runtime.payment_setting)?e.runtime.payment_setting:{},c=a.hasAttribute("data-payment")?JSON.parse(a.getAttribute("data-payment")):{};c.code=i.getAttribute("data-payment-code");var d=e.runtime.tmp.html_payment_str;r.contentWindow.payment_continue=o,r.contentWindow.payment_cancel=n,r.contentWindow.payment_setting=t,r.contentWindow.current_select=c,r.contentWindow.ladi_uid=e.runtime.store_ladiuid,r.contentWindow.end_point_api=e.const.API_LADISALE_LIST_GATEWAY,r.contentDocument.open(),r.contentDocument.write(d),r.contentDocument.close()};isEmptyLadiPage(e.runtime.tmp.html_payment_str)?fetch(e.const.URL_LADI_PAYMENT()).then(t=>t.text()).then(t=>{e.runtime.tmp.html_payment_str=t,c()}).catch(t=>{}):c()},LadiPageScriptV2.prototype.checkValidateSendFormCheckout=function(t){try{if(0==t.querySelectorAll('[data-form-checkout-item="product"] .ladi-form-checkout-payment-check.checked').length)throw new TypeError("no product")}catch(t){return this.showMessage(this.const.LANG.FORM_VALIDATE_CHECKOUT_PRODUCT),!1}try{var e=JSON.parse(t.getAttribute("data-payment"));if(0==Object.keys(e).length)throw new TypeError("no payment")}catch(t){return this.showMessage(this.const.LANG.FORM_VALIDATE_CHECKOUT_PAYMENT),!1}return!0},LadiPageScriptV2.prototype.runOptionFormCheckout=function(){for(var t=this,e=function(e){try{var i=t.findAncestor(e,"ladi-form-checkout-box"),a=JSON.parse(i.getAttribute("data-product"));if(isEmptyLadiPage(a.min))throw new TypeError("no min");return parseInt(a.min)||1}catch(t){return 1}},i=function(e){try{var i=t.findAncestor(e,"ladi-form-checkout-box"),a=JSON.parse(i.getAttribute("data-product"));if(isEmptyLadiPage(a.max))throw new TypeError("no max");return parseInt(a.max)||1}catch(t){return 1e6}},a=function(t){var a=parseInt(t.target.value);a<e(t.target)&&(a=e(t.target)),a>i(t.target)&&(a=i(t.target)),t.target.value=a,r(t)},n=function(t){var e=t.target.parentElement.querySelector("input");e.value=(parseInt(e.value)||0)+1,e.value>i(t.target)&&(e.value=i(t.target)),r(t)},o=function(t){var i=t.target.parentElement.querySelector("input");i.value=(parseInt(i.value)||0)-1,i.value<e(t.target)&&(i.value=e(t.target)),r(t)},r=function(e){var i=t.findAncestor(e.target,["ladi-form","ladi-element"]).id;let a=[];document.querySelectorAll("#"+i+" .ladi-form-checkout-payment-check.multiple.checked").forEach(t=>{const e=t.closest(".ladi-form-checkout-box"),i=e.querySelector('.ladi-form-checkout-payment-quantity input[type="number"]');if(e){const t=JSON.parse(e.getAttribute("data-product")),n=isEmptyLadiPage(i)?1:parseInt(i.value);a.push({product_variant_id:t.product_variant_id,quantity:n})}}),d(i,{variants:a})},c=function(e){e.stopPropagation();var i=t.findAncestor(e.target,"ladi-element");if("product"==i.getAttribute("data-form-checkout-item")){var a=t.findAncestor(e.target,"ladi-form-checkout-box"),n=a.querySelector(".ladi-form-checkout-payment-check");n.classList.contains("multiple")?n.classList.toggle("checked"):(Array.from(a.parentElement.querySelectorAll(".ladi-form-checkout-payment-check.checked")).forEach(function(t){t.classList.remove("checked")}),n.classList.add("checked")),r(e)}"payment"==i.getAttribute("data-form-checkout-item")&&t.eventFormCheckoutSelectPaymentType(e)},d=function(e,i){t.removeTimeout(t.runtime.tmp.timeout_form_checkout_get_price),t.runtime.tmp.timeout_form_checkout_get_price=t.runTimeout(function(){try{const o=document.querySelector("#"+e+' [data-form-checkout-item="total_price"]');if("none"!=window.getComputedStyle(o).display&&i.variants.length>0){var a=window.ladi("_cart_token").get_cookie(),n={"Content-Type":"application/json"};isEmptyLadiPage(a)||(n["cart-token"]=a),t.sendRequest("POST",t.const.API_LADISALE_PROMOTION,JSON.stringify(i),!0,n,function(e,i,a){try{if(a.readyState==XMLHttpRequest.DONE&&200==i){var n=JSON.parse(e);if(200==n.code&&isObjectLadiPage(n.data)&&isArrayLadiPage(n.data.variants)){const e=n.data.variants.reduce((t,e)=>t+e.price*e.quantity,0),i=n.data.variants.reduce((t,e)=>e.discount?1==e.discount.type?t+e.price*(e.discount.value/100)*e.quantity:t+e.discount.value*e.quantity:t,0),a=e-i;return window.ladi("cart_price").set_data(t.formatCurrency(e,t.runtime.currency,!0)),window.ladi("cart_discount").set_data(t.formatCurrency(i,t.runtime.currency,!0)),void window.ladi("cart_checkout_price").set_data(t.formatCurrency(a,t.runtime.currency,!0))}200==i&&201==i||t.showMessage(n.message)}throw new TypeError("error")}catch(n){window.ladi("cart_price").set_data(t.formatCurrency(0,t.runtime.currency,!0)),window.ladi("cart_discount").set_data(t.formatCurrency(0,t.runtime.currency,!0)),window.ladi("cart_checkout_price").set_data(t.formatCurrency(0,t.runtime.currency,!0))}})}}catch(t){console.error(t)}},500)},s=document.getElementsByClassName("ladi-form"),u=0;u<s.length;u++){for(var l=s[u].querySelectorAll(".ladi-form-checkout-payment-quantity"),p=0;p<l.length;p++){var m=l[p].querySelectorAll("span")[0],_=l[p].querySelectorAll("span")[1];isEmptyLadiPage(m)||m.addEventListener("click",n),isEmptyLadiPage(_)||_.addEventListener("click",o)}var g=s[u].querySelectorAll(".ladi-form-checkout-payment-quantity input");for(p=0;p<g.length;p++)g[p].addEventListener("change",a),a({target:g[p]});var f=s[u].querySelectorAll(".ladi-form-checkout-payment-check, .ladi-form-checkout-payment-content");for(p=0;p<f.length;p++)f[p].style.setProperty("cursor","pointer"),f[p].addEventListener("click",c)}for(u=0;u<s.length;u++){var h=s[u];try{h.querySelectorAll('[data-form-checkout-item="product"]').length>0&&0==h.querySelectorAll('[data-form-checkout-item="product"] .ladi-form-checkout-payment-check.checked').length&&h.querySelector('[data-form-checkout-item="product"] .ladi-form-checkout-payment-check').click()}catch(t){}}},LadiPageScriptV2.prototype.runOptionForm=function(t,e,i){var a,n=this,o=window.ladi("LADI_CAMP_TARGET_URL").get_cookie(),r=window.ladi("LADI_CAMP_CONFIG").get_cookie(),c=document.getElementsByClassName("ladi-form"),d=0,s=null,u=null,l=null,p=null,m=null,_=null,g=null,f=null,h=null,y=null,v=null,E=null,L=null,P=null,w=null,k=null,b=null,A=null,O=null,T=n.runtime.shopping,S=null,x=["utm_source","utm_medium","utm_campaign","utm_term","utm_content"],N=["name","email","phone","address","ward","district","state","country"],C=["email","phone"],D=n.copy(n.runtime.list_set_value_name_country).reverse(),R=function(t,e){var i="_capture_"+t,a=window.ladi(i).get_cookie(),o=!1,r=n.runtime.tmp["cookie_cache_otp_"+t];if(isEmptyLadiPage(a)&&isObjectLadiPage(r)&&!isEmptyLadiPage(r[i])&&(a=r[i],o=!0),isEmptyLadiPage(a)){a=e+"|"+n.runtime.ladipage_id+"|"+Date.now()+"|"+n.randomId();var c=new Date;c.setTime(c.getTime()+9e5),o?(r[i]=a,n.runtime.tmp["cookie_cache_otp_"+t]=r):window.ladi(i).set_cookie(a,c)}return a},F=function(t,e,i){var a=n.runtime.tmp["form_data_ladi_"+v];if(isObjectLadiPage(a))return!0;if(e&&isEmptyLadiPage(u[i]))return!1;var o=!0,r=t.getElementsByClassName("ladi-survey");for(f=0;f<r.length;f++){var c=n.findAncestor(r[f],"ladi-element");if(!isEmptyLadiPage(c)){var d=n.runtime.eventData[c.id];if(!isEmptyLadiPage(d)&&d["option.survey_setting.input_required"]&&!isEmptyLadiPage(d["option.survey_setting.input_name"])&&(!e||d["option.survey_setting.input_name"]==i)){var s=c.id,l=t.querySelector('.ladi-element.ladi-form-item-survey[data-name="'+d["option.survey_setting.input_name"]+'"]');isEmptyLadiPage(l)||(s=l.id);var p=window.ladi(s).value();if(isEmptyLadiPage(p)){o=!1;break}}}}var m=null;if(Array.from(document.querySelectorAll('.ladi-form-checkbox-box-item input[data-other="true"]:checked, .ladi-form-checkbox-box-item input[type="radio"][data-other="true"]:checked')).forEach(function(t){o&&isEmptyLadiPage(t.value)&&(o=!1,m=function(){var e=t.parentElement.getElementsByClassName("ladi-editing")[0];isEmptyLadiPage(e)||e.focus()})}),!o)return e||n.showMessage(n.const.LANG.FORM_INPUT_REQUIRED_ERROR,null,m),!1;var _=[];if(A.forEach(function(t){isEmptyLadiPage(u[t])&&_.push(t)}),e&&(_=_.only([i])),_.length>0)return e||n.showMessage(n.const.LANG.FORM_INPUT_REQUIRED_ERROR,null,function(){var e=t.querySelector('[name="'+_[0]+'"]');isEmptyLadiPage(e)||e.focus()}),!1;var g=!0,f=0,h=function(){var e=t.querySelector('[name="'+O[f].name+'"]');isEmptyLadiPage(e)||e.focus()};for(f=0;f<O.length;f++)if(!e||O[f].name==i){var y=u[O[f].name];if(!isEmptyLadiPage(y))try{if(!new RegExp("^"+O[f].pattern+"$",O[f].pattern_flag).test(y)){e||n.showMessage(O[f].title,null,h),g=!1;break}}catch(t){}}return g},q=function(t,e){u={},l={},p={},m={};for(var i=t.querySelectorAll(".ladi-element .ladi-form-item-container [name]"),a={},o=null,r=0;r<i.length;r++)o=i[r].getAttribute("name"),a[o]=parseInt(i[r].getAttribute("tabindex"))||0;var c=Object.keys(a).sort(function(t,e){return a[t]-a[e]});if(c.only(n.runtime.list_set_value_name_country).length==n.runtime.list_set_value_name_country.length)for(var d=0;d<c.length;d++){var s=n.runtime.list_set_value_name_country.indexOf(c[d]);-1!=s&&(c[d]=D[s])}for(var g=0;g<c.length;g++)u[c[g]]="";f=c;for(var h=0;h<i.length;h++){o=i[h].getAttribute("name"),i[h].required&&-1==A.indexOf(o)&&A.push(o);var y=null;if("INPUT"==i[h].tagName){y=i[h].getAttribute("type").trim().toLowerCase();var v=i[h].getAttribute("pattern"),E=i[h].getAttribute("title");if("email"==y?O.push({name:o,pattern:'(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))',pattern_flag:"gi",title:n.const.LANG.FORM_INPUT_EMAIL_REGEX}):isEmptyLadiPage(v)||O.push({name:o,pattern:v,title:isEmptyLadiPage(E)?n.const.LANG.FORM_INPUT_TEXT_REGEX:E}),"checkbox"==y){isArrayLadiPage(u[o])||(u[o]=[]),i[h].checked&&u[o].push(i[h].value);continue}if("radio"==y){i[h].checked&&(u[o]=i[h].value);continue}}if(u[o]=i[h].value,i[h].classList.contains("ladi-form-control-file")&&(u[o]=JSON.parse(i[h].getAttribute("data-path-file")||"[]"),m[o]=!0),"coupon"==o&&"INPUT"==i[h].tagName&&"text"==y&&"true"==i[h].getAttribute("data-replace-coupon")&&(u[o]=n.runtime.tmp.current_use_coupon||""),"INPUT"==i[h].tagName&&"date"==y&&!isEmptyLadiPage(u[o])){var L=i[h].getAttribute("date-format")||"dd-mm-yyyy",P=new Date(u[o]),w=L;w=(w=(w=(w=w.replaceAll("dd",(P.getDate()<10?"0":"")+P.getDate())).replaceAll("mm",(P.getMonth()+1<10?"0":"")+(P.getMonth()+1))).replaceAll("yyyy",P.getFullYear())).replaceAll("yy",P.getFullYear()-2e3),u[o]=w,l[o]=L}}return e||N.forEach(function(t){isNullLadiPage(u[t])||n.setCookieDomains("_ladipage_"+t,Base64.encode(u[t]),365)}),_=n.runtime.tmp.convertFormDataObjectCountry(u),{formDataObject:u}},I=function(t,e,a,c,p){var _=n.runtime.website_id,g={form_config_id:h,ladi_form_id:v,ladipage_id:n.runtime.ladipage_id,tracking_form:[],form_data:[],data_key:c};if(isEmptyLadiPage(_)||(g.website_id=_),a)g.status_send=n.const.STATUS_SEND.capture;else if(g.status_send=n.const.STATUS_SEND.sendform,T){var A=window.ladi("_checkout_token").get_cookie();isEmptyLadiPage(A)||(g.checkout_token=A)}try{Array.from(document.querySelectorAll("#"+v+' .ladi-element[data-form-checkout-item="product"] .ladi-form-checkout-payment-check.checked')).forEach(function(t){var e=n.findAncestor(t,"ladi-form-checkout-box"),i=e.getAttribute("data-product");(i=JSON.parse(i)).quantity=1;var a=e.querySelector(".ladi-form-checkout-payment-quantity input");isEmptyLadiPage(a)||(i.quantity=parseInt(a.value)||i.quantity),isArrayLadiPage(g.product_checkout)||(g.product_checkout=[]),g.product_checkout.push(`${i.product_variant_id}:${i.quantity}:${i.price}::|${i.name}`)})}catch(t){}if(isEmptyLadiPage(e.voucher_id)||(g.voucher_id=e.voucher_id),isEmptyLadiPage(e.voucher_code)||(g.voucher_code=e.voucher_code),!isEmptyLadiPage(E)){var O=E.getElementsByClassName("ladiflow-widget")[0];isEmptyLadiPage(O)||(isObjectLadiPage(g.options)||(g.options={}),g.options.ladiflow_trigger_id=O.getAttribute("ladiflow-trigger-id"),g.options.ladiflow_ref=O.getAttribute("ladiflow-ref"),g.options.ladiflow_page_id=O.getAttribute("page_id"),g.options.ladiflow_checkbox_user_ref=O.getAttribute("user_ref"),g.options.ladiflow_store_id=O.getAttribute("ladiflow-store-id"),d=1e3,s=function(){isObjectLadiPage(window.LadiFlow)&&isFunctionLadiPage(window.LadiFlow.resetWidgetCheckbox)&&window.LadiFlow.resetWidgetCheckbox(O.id)})}isEmptyLadiPage(L)||["option.sync_ladisales_form_account_id","option.sync_ladiflow_form_account_id","option.sync_ladishare_form_account_id","option.sync_ladichat_form_account_id"].forEach(function(t){isEmptyLadiPage(L[t])||(isObjectLadiPage(g.options)||(g.options={}),isArrayLadiPage(g.options.external_form_config_ids)||(g.options.external_form_config_ids=[]),g.options.external_form_config_ids.push(L[t]))}),e.isFormOtp&&!isEmptyLadiPage(y)&&(isObjectLadiPage(g.options)||(g.options={}),isObjectLadiPage(g.options.external_otp_config)||(g.options.external_otp_config={}),g.options.external_otp_config.otp_config_id=y),isObjectLadiPage(g.options)&&(g.options=JSON.stringify(g.options)),isEmptyLadiPage(P)||(g.total_revenue=P),isEmptyLadiPage(n.runtime.time_zone)||(g.time_zone=n.runtime.time_zone);var N=Object.keys(LadiFormApi);if((f=function(t){var e=[],i=0,a=["state","district","ward"];for(i=0;i<t.length&&!a.includes(t[i]);i++)e.push(t[i]);var n=Array.from(document.querySelectorAll("#"+v+" .ladi-form-control[data-select-index]")),o=Array.from(document.querySelectorAll("#"+v+' input.ladi-form-control[data-select-index][name="ward"]')),r=n.map(function(t){return(parseInt(t.getAttribute("data-select-index"))||0)+"|"+t.getAttribute("name")});for(r.sort(function(t,e){return parseInt(t.split("|")[0])-parseInt(e.split("|")[0])}),n=r.map(function(t){return t.split("|")[1]}),i=0;i<n.length;i++)e.push(n[i]);for(n.length>0&&e.push("country"),isEmptyLadiPage(o)||e.except(["ward"]),i=e.length;i<t.length;i++)e.push(t[i]);return e=e.unique(),e=JSON.stringify(e),e=JSON.parse(e)}(f)).forEach(function(t){var e=u[t];if(isArrayLadiPage(e)&&0==e.length&&(e=""),e=-1!=N.indexOf(t)?LadiFormApi[t]:e,"products"==t&&-1!=f.indexOf("quantity"))try{var i=e.split("|");if(2==i.length){var a=i[0].split(":");5==a.length&&(a[1]=u.quantity),i[0]=a.join(":")}e=i.join("|")}catch(t){}var n={name:t,value:e};m[t]&&(n.is_file=!0),isEmptyLadiPage(l[t])||(n.format=l[t]),g.form_data.push(n)}),(N=N.except(f)).forEach(function(t){g.form_data.push({name:t,value:LadiFormApi[t]})}),T){if(!isNullLadiPage(w)){g.form_data.push({name:"cart_products",value:w,is_ladipage:!0}),isEmptyLadiPage(n.runtime.tmp.add_to_cart_shipping_method_id)||g.form_data.push({name:"cart_shipping",value:n.runtime.tmp.add_to_cart_shipping_method_id+"|"+(n.runtime.tmp.add_to_cart_fee_shipping||0),is_ladipage:!0});var C=g.form_data.findIndex(function(t){return"coupon"==t.name});-1!=C&&(g.form_data[C].is_ladipage=!0)}isEmptyLadiPage(P)||g.form_data.push({name:"cart_revenue",value:P,is_ladipage:!0}),isEmptyLadiPage(n.runtime.tmp.current_use_coupon)||g.form_data.push({name:"cart_coupon_amount",value:n.runtime.tmp.add_to_cart_discount||0,is_ladipage:!0})}g.tracking_form.push({name:"url_page",value:window.location.href}),n.runtime.has_popupx&&g.tracking_form.push({name:"origin_url_page",value:n.runtime.tmp.popupx_origin_url}),x.forEach(function(t){var e=S[t];e=isNullLadiPage(e)?"":e,g.tracking_form.push({name:t,value:e})}),g.tracking_form.push({name:"variant_url",value:o}),g.tracking_form.push({name:"variant_content",value:n.generateVariantContentString(r,!0)}),isEmptyLadiPage(i)||g.tracking_form.push({name:n.const.REF_NAME,value:i}),n.runtime.tmp["form_data_ladi_tmp_"+v]=n.copy(g);var D=n.runtime.tmp["form_data_ladi_"+v];isObjectLadiPage(D)&&(g=n.copy(D)),isEmptyLadiPage(k)||(g.captcha_token=k,g.captcha_type=b);e.isFormOtp&&(e.isSetOtpId&&function(){var t="_otp_id_"+v,i=window.ladi(t).get_cookie(),a=!1,o=n.runtime.tmp["cookie_cache_otp_"+v];isEmptyLadiPage(i)&&isObjectLadiPage(o)&&!isEmptyLadiPage(o[t])&&(i=o[t],a=!0);var r=new Date,c=[];isEmptyLadiPage(i)?c=[n.randomId(),r.getTime(),1]:((c=i.split("|"))[1]=parseInt(c[1])||Date.now(),c[2]=parseInt(c[2])||1,e.isSendOtp||(c[2]+=1),c.splice(3)),c[2]<=1?g.otp_send=n.const.OTP_TYPE.send:g.otp_send=n.const.OTP_TYPE.resend,r.setTime(c[1]+9e5),i=c.join("|"),a?(o[t]=i,n.runtime.tmp["cookie_cache_otp_"+v]=o):window.ladi(t).set_cookie(i,r),c.splice(1),i=c.join("|"),g.otp_id=i}(),g.is_capture=e.isCapture,g.otp_type=n.const.OTP_TYPE.sms,g.status_send=n.const.STATUS_SEND.otp),e.isSendOtp&&(g.otp_code=e.otp_code,g.status_send=n.const.STATUS_SEND.sendform),isFunctionLadiPage(p)&&p(g)},M=function(t){t.reset();var e=t.getElementsByClassName("ladi-survey-option");for(X=0;X<e.length;X++)e[X].classList.remove("selected");var i=t.querySelectorAll(".ladi-element .ladi-form-item-container .ladi-form-checkbox-item input");for(X=0;X<i.length;X++){var a=n.findAncestor(i[X],"ladi-form-checkbox-item").querySelector("span");isEmptyLadiPage(a)||a.setAttribute("data-checked",i[X].checked)}var o=n.findAncestor(t,"ladi-element");if(!isEmptyLadiPage(o)){for(var r=document.querySelectorAll('.ladi-form [data-submit-form-id="'+o.id+'"]'),c=0;c<r.length;c++){var d=n.findAncestor(r[c],"ladi-form");if(!isEmptyLadiPage(d)&&(d=n.findAncestor(d,"ladi-element"),!isEmptyLadiPage(d))){var s=d.querySelector(".ladi-form-remove-coupon");if(isEmptyLadiPage(s)){var u=d.querySelector('input[name="coupon"]');isEmptyLadiPage(u)||(u.value="",n.fireEvent(u,"change"))}else s.click()}}var l=document.getElementById(o.getAttribute("data-form-id-before"));isEmptyLadiPage(l)||o.id==l.id||(l=l.getElementsByClassName("ladi-form")[0],M(l))}for(var p=document.querySelectorAll('[data-combobox-type="delivery_method"]'),m=0;m<p.length;m++)p[m].hasAttribute("data-placeholder")&&(p[m].innerHTML='<option value="">'+p[m].getAttribute("data-placeholder")+"</option>"),p[m].setAttribute("data-selected","");for(var _=document.querySelectorAll(".ladi-google-recaptcha-checkbox[data-widget-id]"),g=0;g<_.length;g++){var f=_[g].getAttribute("data-widget-id");isEmptyLadiPage(f)||window.grecaptcha&&isObjectLadiPage(n.runtime.tmp.google_captcha)&&n.runtime.tmp.google_captcha.checkbox&&isFunctionLadiPage(window.grecaptcha.reset)&&window.grecaptcha.reset(f)}var h=document.querySelectorAll(".ladi-form .ladi-form-checkbox-box-item");for(g=0;g<h.length;g++)n.runFormItemOtherChange(h[g].getElementsByClassName("ladi-form-checkbox-item")[0],!0);n.runtime.tmp.add_to_cart_shipping_method_id=null},j=function(t,e,i,a){if(q(i,!1),e.isSendFormCheckout){var o=n.findAncestor(i,"ladi-element"),r=o.querySelector(".ladi-button");return r=n.findAncestor(r,"ladi-element"),n.runEventTracking(o.id,{is_return_string:e.isSendFormCheckout,is_form:!0,event:{target:r}},u),void n.sendFormCheckout(i,{setFormData:q,resetFormValue:M,setFormDataObjectThankyou:H})}F(i,!1,null)&&(I(0,e,!1,a,function(t){n.sendRequest("POST",n.const.API_FORM_DATA,JSON.stringify(t),!0,{"Content-Type":"application/json"})}),n.showMessage(n.const.LANG.FORM_SEND_DATA_NO_CONFIG),M(i))},U=function(){n.showMessage(n.const.LANG.FORM_CAPTCHA_ERROR)},Y=function(t,e){var i={},a=function(t){return"form_show_popup_default"==t.type&&(isEmptyLadiPage(t.text_thankyou_value)||(t.text_thankyou_value=n.convertDataReplaceStr(t.text_thankyou_value,!1,null,!1,g))),"form_redirect_url"==t.type&&(isEmptyLadiPage(t.redirect_url)||(t.redirect_url=window.ladi(t.redirect_url).encode_thankyou_url(),t.redirect_url=window.ladi(t.redirect_url).get_url(p,e,!1))),"form_open_app_mobile"==t.type&&(n.runtime.isBrowserDesktop||isEmptyLadiPage(t.app_link)?t.app_link="":(t.app_link=window.ladi(t.app_link).encode_thankyou_url(),t.app_link=n.convertDataReplaceStr(t.app_link,!0,null,!1,g))),t};try{i=JSON.parse(t["option.funnelx_config"])}catch(t){}i=isObjectLadiPage(i)?i:{},isArrayLadiPage(i.configs)&&i.configs.forEach(function(t,e){i.configs[e].actions=t.actions.map(a)}),isArrayLadiPage(i.default_actions)&&(i.default_actions=i.default_actions.map(a));var o=n.copy(g);LadiPageScript.runtime.tmp.runActionPopupX({ladipage_id:n.runtime.ladipage_id,form_data:o,funnelx_config:i,action:{type:"thankyou_form_funnelx"}})},B=function(t,e,i,a,o){if(_={},g={},f=[],A=[],O=[],q(t,i),F(t,i,a)){for(var r=t.querySelectorAll(".ladi-element .ladi-form-item-container [name]"),c={},d={},s=null,l=0;l<r.length;l++){s=n.findAncestor(r[l],"ladi-element");var p=r[l].getAttribute("name");c[p]=s.id,d[p]=s.outerHTML}var m=e["option.form_setting"],h=Object.keys(c),y=function(e){var u=document.getElementById(e);if(!isEmptyLadiPage(u)){u.setAttribute("data-form-id-before",t.id);var p=n.runtime.eventData[u.id];if(!i||!isEmptyLadiPage(p)&&p["option.form_auto_capture"]){isFunctionLadiPage(o.getOtp)&&!isEmptyLadiPage(p)&&p["option.is_form_otp"]&&(isFunctionLadiPage(o.beforeRunOtp)&&o.beforeRunOtp(u),n.runtime.func_get_code_otp[u.id]=o.getOtp);var m=[];if(h.forEach(function(t){var e=window.ladi(c[t]).value();if(0==(r=u.querySelectorAll('.ladi-element .ladi-form-item-container [name="'+t+'"]')).length){var i=document.createElement("div");i.innerHTML=d[t],(i=i.childNodes[0]).id=n.randomString(10),i.classList.add("ladi-hidden"),u.getElementsByClassName("ladi-form")[0].appendChild(i),r=[i.querySelector('[name="'+t+'"]')]}var o=[];for(l=0;l<r.length;l++)s=n.findAncestor(r[l],"ladi-element"),o.push(s.id),t==a&&m.push(r[l]);for(o=o.unique(),l=0;l<o.length;l++)window.ladi(o[l]).value(e)}),i)for(l=0;l<m.length;l++)n.fireEvent(m[l],"focusout")}}};if((m.mapping_form_id||[]).forEach(y),!i){n.runtime.is_funnelx&&(n.runtime.tmp.multipleFormRunFormParent=y,H(),Y(e,!1));var v=e["option.data_event"];if(!isArrayLadiPage(v)){var E=n.copy(m);if(v=[],isObjectLadiPage(E)&&(E.type=E.event_type,E.value=E.event_value,E.is_hide_parent=E.event_is_hide_parent,E.change_index_type=E.event_change_index_type,E.change_index_number=E.event_change_index_number,!isEmptyLadiPage(E.value))){if(E.type!=n.const.DATA_ACTION_TYPE.section&&E.type!=n.const.DATA_ACTION_TYPE.popup||v.push({action_type:n.const.ACTION_TYPE.complete,type:E.type,action:E.value}),E.type==n.const.DATA_ACTION_TYPE.section&&E.is_hide_parent||E.type==n.const.DATA_ACTION_TYPE.popup){var L=n.findAncestor(t,"ladi-popup"),P=n.findAncestor(t,"ladi-section"),w=null;isEmptyLadiPage(L)?isEmptyLadiPage(P)||(w=P.id):w=(L=n.findAncestor(L,"ladi-element")).id,isEmptyLadiPage(w)||v.push({action_type:n.const.ACTION_TYPE.complete,type:n.const.DATA_ACTION_TYPE.hidden_show,hidden_ids:[w],show_ids:[]})}E.type==n.const.DATA_ACTION_TYPE.change_index&&v.push({action_type:n.const.ACTION_TYPE.complete,type:E.type,action:E.value,change_index_type:E.change_index_type,change_index_number:E.change_index_number})}}n.runtime.tmp.runDataEventNow(t,v,{action_type:n.const.ACTION_TYPE.complete})}o.isRunTracking&&n.runEventTracking(t.id,{is_form:!0,is_form_multiple:!0},u)}},H=function(){p=n.copy(u),g=n.copy(_),isObjectLadiPage(n.runtime.tmp.form_data_otp_current)&&(p=n.copy(n.runtime.tmp.form_data_otp_current)),Object.keys(n.runtime.replaceStr).forEach(function(t){p.hasOwnProperty(t)||(p[t]=n.runtime.replaceStr[t]),g.hasOwnProperty(t)||(g[t]=n.runtime.replaceStr[t])});var t=[];return isEmptyLadiPage(i)||t.push({key:n.const.REF_NAME,value:i}),t.forEach(function(t){p.hasOwnProperty(t.key)||(p[t.key]=t.value),g.hasOwnProperty(t.key)||(g[t.key]=t.value)}),{formDataObjectThankyou:p,formDataObjectConvertThankyou:g}},G=function(e,i,a,o,r,c){if(i=isObjectLadiPage(i)?i:{},!(c=isObjectLadiPage(c)?c:{}).isSendFormCheckout||n.checkValidateSendFormCheckout(e))if(S=n.getURLSearchParams(null,null,!1),d=0,s=null,u={},l={},p={},m={},_={},g={},f=[],h=null,y=null,v=null,E=null,L=null,P=null,w=null,k=i.captcha_token,isObjectLadiPage(n.runtime.tmp.google_captcha)&&(b=n.runtime.tmp.google_captcha.type,!a&&isEmptyLadiPage(k)&&i.hasOwnProperty("captcha_token")))U();else{A=[],O=[],T=n.findAncestor(e,"ladi-popup"),isEmptyLadiPage(T)?T=!1:(T=n.findAncestor(T,"ladi-element"),T=!isEmptyLadiPage(T)&&"POPUP_CHECKOUT"==T.id);var N=e.getElementsByClassName("ladi-form")[0];if(!isEmptyLadiPage(N)){var C=n.runtime.eventData[e.id];if(!isEmptyLadiPage(C)){if(C["option.is_add_to_cart"])return;h=C["option.form_config_id"],y=isObjectLadiPage(C["option.form_setting"])?C["option.form_setting"].otp_config_id:null,v=e.id,E=e,L=C,P=parseFloatLadiPage(C["option.form_purchase_value"])||0,T&&(P=n.getCartCheckoutPrice(P),w=n.getCartProducts())}var D=null,R=e.getAttribute("data-button-submit-other"),B=null,J=null;if(a){if(isEmptyLadiPage(o))return;if(q(N,a),!F(N,a,r))return;if(i.captcha&&!isEmptyLadiPage(C)&&C["option.form_captcha"]&&isObjectLadiPage(n.runtime.tmp.google_captcha)){if(window.grecaptcha)if(n.runtime.tmp.google_captcha.enterprise&&window.grecaptcha.enterprise)window.grecaptcha.enterprise.ready(function(){try{window.grecaptcha.enterprise.execute(n.runtime.tmp.google_captcha.api_key,{action:"submit"}).then(function(t){G(e,{captcha_token:t},a,o,r,c)})}catch(t){}});else if(n.runtime.tmp.google_captcha.checkbox)try{D=e.getElementsByClassName("ladi-google-recaptcha-checkbox")[0],isEmptyLadiPage(R)||(D=document.querySelector("#"+R+" .ladi-google-recaptcha-checkbox")),B=D.getAttribute("data-widget-id"),J=window.grecaptcha.getResponse(B),G(e,{captcha_token:J},a,o,r,c)}catch(t){}else window.grecaptcha.ready(function(){try{window.grecaptcha.execute(n.runtime.tmp.google_captcha.api_key,{action:"submit"}).then(function(t){G(e,{captcha_token:t},a,o,r,c)})}catch(t){}});return}I(0,c,a,o,function(t){var e=t.form_data.findIndex(function(t){return t.name==r}),i=-1!=e?t.form_data[e].value:null;!isEmptyLadiPage(n.runtime.tmp.capture_form_data_last[o+"_"+r])&&equalsLadiPage(n.runtime.tmp.capture_form_data_last[o+"_"+r],i)||(n.runtime.tmp.capture_form_data_last[o+"_"+r]=i,n.sendRequest("POST",n.const.API_FORM_DATA,JSON.stringify(t),!0,{"Content-Type":"application/json"}))})}else if(isEmptyLadiPage(C))j(0,c,N,o);else if(isNullLadiPage(n.runtime.tmp.form_sending)&&(n.runtime.tmp.form_sending={}),isNullLadiPage(n.runtime.tmp.form_button_headline)&&(n.runtime.tmp.form_button_headline={}),!n.runtime.tmp.form_sending[e.id]){var K=function(){n.runtime.tmp.form_sending[e.id]=!0;var t=N.querySelector(".ladi-button .ladi-headline");isNullLadiPage(n.runtime.tmp.form_button_headline[e.id])&&(n.runtime.tmp.form_button_headline[e.id]=t.innerHTML),c.isFormOtp||(t.innerHTML="● ● ●")},W=N.getElementsByClassName("ladi-button")[0];W=n.findAncestor(W,"ladi-element"),isEmptyLadiPage(R)||(W=document.getElementById(R));var V=function(){delete n.runtime.tmp.form_sending[e.id],N.querySelector(".ladi-button .ladi-headline").innerHTML=n.runtime.tmp.form_button_headline[e.id]};if(isNullLadiPage(c.voucher_id)&&!isEmptyLadiPage(C)&&C["option.form_set_voucher_id"])return K(),void function(t){n.runtime.tmp.voucher_info={};var i={event:"getVoucher",voucher_id:C["option.form_set_voucher_id"],pixel_id:n.runtime.store_id,time_zone:n.runtime.time_zone,domain:window.location.host,url:window.location.href,customer:function(t){try{var i=e.querySelector(`.ladi-element .ladi-form-item input.ladi-form-control[name="${t}"]`);return i?i.value:""}catch(t){}return""}(C["option.form_customer_input_name"]),ladipage_id:n.runtime.ladipage_id};n.sendRequest("POST",n.const.API_ANALYTICS_EVENT,JSON.stringify(i),!0,{"Content-Type":"application/json"},function(e,i,a){if(a.readyState==XMLHttpRequest.DONE&&isFunctionLadiPage(t))try{var o=JSON.parse(e);n.runtime.tmp.voucher_info={voucher_id:o.data.id||"",voucher_code:o.data.voucher_code,message:o.message},t(n.runtime.tmp.voucher_info.voucher_id,n.runtime.tmp.voucher_info.voucher_code),C["option.form_voucher_show_error"]&&isObjectLadiPage(n.runtime.tmp.voucher_info)&&isEmptyLadiPage(n.runtime.tmp.voucher_info.voucher_code)&&!isEmptyLadiPage(n.runtime.tmp.voucher_info.message)&&n.showMessage(n.runtime.tmp.voucher_info.message)}catch(e){t("","")}})}(function(t,n){V(),G(e,i,a,o,r,Object.assign(c,{voucher_id:t,voucher_code:n}))});if(i.captcha&&!isEmptyLadiPage(C)&&C["option.form_captcha"]&&isObjectLadiPage(n.runtime.tmp.google_captcha))if(window.grecaptcha)if(K(),n.runtime.tmp.google_captcha.enterprise&&window.grecaptcha.enterprise)window.grecaptcha.enterprise.ready(function(){try{window.grecaptcha.enterprise.execute(n.runtime.tmp.google_captcha.api_key,{action:"submit"}).then(function(t){V(),G(e,{captcha_token:t},a,o,r,c)}).catch(function(){U(),V()})}catch(t){U(),V()}});else if(n.runtime.tmp.google_captcha.checkbox)try{D=e.getElementsByClassName("ladi-google-recaptcha-checkbox")[0],R=e.getAttribute("data-button-submit-other"),isEmptyLadiPage(R)||(D=document.querySelector("#"+R+" .ladi-google-recaptcha-checkbox")),B=D.getAttribute("data-widget-id"),J=window.grecaptcha.getResponse(B),V(),G(e,{captcha_token:J},a,o,r,c)}catch(t){U(),V()}else window.grecaptcha.ready(function(){try{window.grecaptcha.execute(n.runtime.tmp.google_captcha.api_key,{action:"submit"}).then(function(t){V(),G(e,{captcha_token:t},a,o,r,c)}).catch(function(){U(),V()})}catch(t){U(),V()}});else n.showMessage(n.const.LANG.FORM_CAPTCHA_LOADING);else{var z=C["option.form_send_ladipage"],$=C["option.form_api_data"],Q=C["option.thankyou_type"],X=C["option.thankyou_value"],Z=C["option.deeplink_value"],tt=C["option.form_auto_funnel"],et=C["option.form_thankyou_funnel"],it=function(){if(p=Object.assign(p,n.runtime.tmp.voucher_info),g=Object.assign(g,n.runtime.tmp.voucher_info),isObjectLadiPage(c)&&isFunctionLadiPage(c.callbackOtpShowThankYouDone)&&c.callbackOtpShowThankYouDone(),isFunctionLadiPage(s)&&s(),C["option.form_voucher_show_thankyou_when_error"]||!C["option.form_voucher_show_error"]||!isObjectLadiPage(n.runtime.tmp.voucher_info)||!isEmptyLadiPage(n.runtime.tmp.voucher_info.voucher_code)||isEmptyLadiPage(n.runtime.tmp.voucher_info.message))if(n.runtime.is_funnelx)Y(C,tt);else{var i=!1;if(n.runtime.has_popupx&&n.runtime.tmp.popupx_is_inline)i=!0;else if(Q!=n.const.FORM_THANKYOU_TYPE.url){var a=n.findAncestor(e,"ladi-popup");isEmptyLadiPage(a)||(a=n.findAncestor(a,"ladi-element"),n.runRemovePopup(a.id,t))}var o=0;if(!n.runtime.isBrowserDesktop&&!isEmptyLadiPage(Z)){o=1e3,Z=window.ladi(Z).encode_thankyou_url();var r=n.convertDataReplaceStr(Z,!0,null,!1,g);window.ladi(r).open_url()}var d=window.ladi("LADI_FUNNEL_NEXT_URL").get_cookie();if(!et||isEmptyLadiPage(d)){if(Q==n.const.FORM_THANKYOU_TYPE.default&&(isEmptyLadiPage(X)||n.showMessage(X,g)),Q==n.const.FORM_THANKYOU_TYPE.popup&&(tt&&n.setDataReplaceElement(!1,!1,g,X),window.ladi(X).show(!1,{formThankyouPopupXInline:i})),Q==n.const.FORM_THANKYOU_TYPE.url&&!isEmptyLadiPage(X)){X=window.ladi(X).encode_thankyou_url();var u=window.ladi(X).get_url(p,tt,!1);n.runTimeout(function(){window.ladi(u).open_url()},o)}}else{d=window.ladi(d).encode_thankyou_url();var l=window.ladi(d).get_url(p,tt,!1);n.runTimeout(function(){window.ladi(l).open_url()},o)}}},at=function(){c.isSendFormCheckout?n.sendFormCheckout(e,{setFormData:q,resetFormValue:M,setFormDataObjectThankyou:H}):isFunctionLadiPage(window.ladipage_before_thankyou)?window.ladipage_before_thankyou(e,it):it()};if(C["option.only_facebook_widget"]){if(isObjectLadiPage(window.LadiFlow)&&isFunctionLadiPage(window.LadiFlow.confirmCheckbox))for(var nt=e.getElementsByClassName("ladiflow-widget"),ot=0;ot<nt.length;ot++)window.LadiFlow.confirmCheckbox(nt[ot].id);return n.runEventTracking(e.id,{is_return_string:c.isSendFormCheckout,is_form:!0,is_facebook_widget:!0},u),void at()}if(isEmptyLadiPage(h)&&isEmptyLadiPage(C["option.sync_ladisales_form_account_id"])&&isEmptyLadiPage(C["option.sync_ladiflow_form_account_id"])&&isEmptyLadiPage(C["option.sync_ladishare_form_account_id"])&&isEmptyLadiPage(C["option.sync_ladichat_form_account_id"]))j(0,c,N,o);else if(q(N,a),F(N,a,r)){var rt=0,ct=0,dt=null,st=[],ut=!1,lt=!1,pt=!0,mt=function(t){t&&M(N),V()},_t=function(t){if(-1!=[n.const.FORM_CONFIG_TYPE.sapo,n.const.FORM_CONFIG_TYPE.shopify,n.const.FORM_CONFIG_TYPE.haravan,n.const.FORM_CONFIG_TYPE.wordpress].indexOf(n.runtime.shopping_product_type)&&n.runtime.tmp.cart.length>0){var e=!1;-1!=[n.const.FORM_CONFIG_TYPE.haravan,n.const.FORM_CONFIG_TYPE.wordpress].indexOf(n.runtime.shopping_product_type)&&(e=!0);var i=n.runtime.tmp.cart[0];return i=JSON.stringify(i),i=encodeURIComponent(i),void n.removeAddToCartProduct(i,!1,e,function(e){e?_t(t):isFunctionLadiPage(t)&&t()})}-1!=[n.const.FORM_CONFIG_TYPE.ladisales].indexOf(n.runtime.shopping_product_type)&&(window.ladi("_cart_token").delete_cookie(),window.ladi("_checkout_token").delete_cookie(),n.createCartData()),isFunctionLadiPage(t)&&t()},gt=function(t,i,a,o){if(a.readyState==XMLHttpRequest.DONE){var r={};try{r=JSON.parse(t)}catch(t){}r=isObjectLadiPage(r)?r:{},o==n.const.API_FORM_DATA?200==r.code?rt++:(1!=r.code||isEmptyLadiPage(r.message)||(dt=r.message),ct++,pt=!1):200==i||201==i?rt++:n.getElementAHref(o).host==n.const.DOMAIN_GOOGLE_DOCS?rt++:ct++,rt+ct==st.length&&(pt&&!ut&&rt>=1?(ut=!0,c.isResendOtp||(n.runtime.tmp.form_data_current=u),isFunctionLadiPage(c.callbackOtp)&&c.callbackOtp(!0),isObjectLadiPage(c)&&isFunctionLadiPage(c.callbackThankyou)?(V(),c.callbackThankyou(c,function(){_t(function(){mt(!0),n.runtime.tmp.current_use_coupon=null})})):(H(),function(t,e,i){var a=null,o=!1,r=function(t,e){o||(isFunctionLadiPage(i)&&i(t,e),n.removeTimeout(a),o=!0)};a=n.runTimeout(r,3e3),n.runtime.tmp.runTrackingAnalytics("FormSubmit",{ladi_form_id:t,total_revenue:e},r)}(e.id,P,function(t,i){n.runEventTracking(e.id,{is_return_string:c.isSendFormCheckout,is_form:!0,event:{target:W}},u),window.ladi("_capture_"+e.id).delete_cookie(),isObjectLadiPage(c)&&isFunctionLadiPage(c.callbackOtpDone)&&c.callbackOtpDone(),_t(function(){n.runTimeout(function(){n.runtime.tmp.current_use_coupon=null,at(),mt(!0)},500)})}))):!lt&&ct>=1&&(isFunctionLadiPage(c.callbackOtp)&&c.callbackOtp(!1),lt=!0,n.showMessage(dt||n.const.LANG.REQUEST_SEND_ERROR),mt(!1)))}},ft=function(t){st.push({url:n.const.API_FORM_DATA,data:JSON.stringify(t),async:!0,headers:{"Content-Type":"application/json"},callback:gt})};z&&I(0,c,a,o,ft),isArrayLadiPage($)&&$.forEach(function(t){if(!isEmptyLadiPage(t.api_url)&&isArrayLadiPage(t.custom_fields)){var e=n.getElementAHref(t.api_url).host==n.const.DOMAIN_GOOGLE_DOCS,i={},a=null,o=null,r=null,c=null;t.custom_fields.forEach(function(t){if(T&&("cart_products"==t.ladi_name&&(a=t.name),"cart_revenue"==t.ladi_name&&(o=t.name),"cart_shipping"==t.ladi_name&&(r=t.name),"cart_coupon_amount"==t.ladi_name&&(c=t.name)),!m[t.ladi_name]){var e=_[t.ladi_name];isNullLadiPage(e)||(isArrayLadiPage(e)?0==e.length?i[t.name]="":i[t.name]=JSON.stringify(e):i[t.name]=e)}}),isEmptyLadiPage(a)||isNullLadiPage(w)||(i[a]=JSON.stringify(w)),isEmptyLadiPage(o)||isNullLadiPage(P)||(i[o]=P),isEmptyLadiPage(r)||isNullLadiPage(n.runtime.tmp.add_to_cart_shipping_method_id)||(i[r]=n.runtime.tmp.add_to_cart_shipping_method_id+"|"+(n.runtime.tmp.add_to_cart_fee_shipping||0)),isEmptyLadiPage(c)||isEmptyLadiPage(n.runtime.tmp.current_use_coupon)||(i[c]=n.runtime.tmp.add_to_cart_discount||0);var d={};if(!isEmptyLadiPage(t.api_request_header))try{var s=JSON.parse(t.api_request_header);Object.keys(s).forEach(function(t){d[t]=s[t]})}catch(t){}if(!e)i.link=window.location.href,n.runtime.has_popupx&&(i.origin_link=n.runtime.tmp.popupx_origin_url),Object.keys(LadiFormApi).forEach(function(t){i[t]=LadiFormApi[t]}),x.forEach(function(t){var e=S[t];isNullLadiPage(e)||(i[t]=e)});var u=null,l=t.content_type||n.const.CONTENT_TYPE.form_urlencoded;if(l==n.const.CONTENT_TYPE.form_urlencoded&&(d["Content-Type"]="application/x-www-form-urlencoded",u=Object.keys(i).reduce(function(t,e){return t.push(e+"="+encodeURIComponent(i[e])),t},[]).join("&")),l==n.const.CONTENT_TYPE.json&&(d["Content-Type"]="application/json",u=JSON.stringify(i)),l==n.const.CONTENT_TYPE.form_data)u=new FormData,Object.keys(i).forEach(function(t){u.append(t,i[t])});st.push({url:t.api_url,data:u,async:!0,headers:d,callback:gt})}});(st.length>0||!z)&&K(),n.runTimeout(function(){0==st.length&&(z?j(0,c,N,o):I(0,c,a,o,ft)),st.forEach(function(t){n.sendRequest("POST",t.url,t.data,t.async,t.headers,t.callback)})},d)}}}}}},J=function(t){var e=n.findAncestor(t.target,"ladi-element");if(!isEmptyLadiPage(e))for(var i=e.querySelectorAll('[type="checkbox"]'),a=0;a<i.length;a++)i[a].removeAttribute("required")},K=function(t){var e=n.findAncestor(t.target,"ladi-element");if(!isEmptyLadiPage(e)){var a=null;if((!isArrayLadiPage(n.runtime.tmp.cart)||n.runtime.tmp.cart.length<=0)&&(a=n.findAncestor(e,["ladi-popup","ladi-element"]),!isEmptyLadiPage(a)&&"POPUP_CHECKOUT"==a.id))return n.showMessage(n.const.LANG.ADD_TO_CART_NO_CART),!1;delete n.runtime.tmp.form_data_otp_current,n.setEventDataFormDynamic(e.id);var o=n.runtime.eventData[e.id];if(isObjectLadiPage(o)&&o["option.is_form_otp"])return!1;for(var r=e.querySelectorAll('[ladi-checkbox-required="true"]'),c=-1,d=0;d<r.length;d++)if(0==r[d].querySelectorAll('[type="checkbox"]:checked').length){c=d;break}if(-1==c){var s=function(t){var i=!1,a=null;isEmptyLadiPage(o["option.form_config_id"])||((o["option.form_auto_capture"]||t.isFormOtp)&&(a=R(e.id,o["option.form_config_id"])),o["option.form_auto_capture"]&&(i=!0));var n={captcha:!0};(t.isResendOtp||t.isSendOtp)&&(n.captcha=!1),t.isFormOtp&&(t.isCapture=i),G(e,n,!1,a,null,t)},l=function(t){window.ladi("_capture_"+e.id).delete_cookie(),window.ladi("_otp_id_"+e.id).delete_cookie();var i=[];isObjectLadiPage(o["option.form_setting"])&&(i=o["option.form_setting"].mapping_form_id||[]),i.forEach(function(e){window.ladi("_otp_time_"+e).delete_cookie(),t&&delete n.runtime.tmp["cookie_cache_otp_"+e]}),t&&(delete n.runtime.tmp["cookie_cache_otp_"+e.id],delete n.runtime.tmp["form_data_ladi_"+e.id],delete n.runtime.tmp["form_data_ladi_tmp_"+e.id])},p=function(t){n.runtime.tmp.form_data_otp_current=n.runtime.tmp.form_data_current;var e=t.getElementsByClassName("ladi-form")[0];a=n.findAncestor(t,["ladi-popup","ladi-element"]);var i=function(){var i=t.getAttribute("data-form-id-before");delete n.runtime.func_get_code_otp[t.id],delete n.runtime.tmp["cookie_cache_otp_"+t.id],delete n.runtime.tmp["cookie_cache_otp_"+i],delete n.runtime.tmp["form_data_ladi_"+i],delete n.runtime.tmp["form_data_ladi_tmp_"+i],window.ladi("_otp_time_"+t.id).delete_cookie(),window.ladi("_otp_id_"+i).delete_cookie(),t.removeAttribute("data-form-id-before"),e.onsubmit=function(){return!1}},o=function(){isEmptyLadiPage(a)||window.ladi(a.id).hide(),e.reset()};e.onsubmit=function(){var e=t.querySelector('input[name="otp"]');return isEmptyLadiPage(e)||(e=e.value.trim(),s({isFormOtp:!0,isSetOtpId:!0,isSendOtp:!0,otp_code:e,callbackOtpDone:i,callbackOtpShowThankYouDone:o})),!1}},m=function(t,e){s({isFormOtp:!0,isSetOtpId:!0,isResendOtp:t,callbackOtp:e,callbackThankyou:h})},h=function(t,i){t.isFormOtp&&!t.isResendOtp&&function(){var t={};t["_capture_"+e.id]=null,t["_otp_id_"+e.id]=null;var i=Object.keys(t);i.forEach(function(e){t[e]=window.ladi(e).get_cookie()}),n.runtime.tmp["cookie_cache_otp_"+e.id]=t;var a=[];isObjectLadiPage(o["option.form_setting"])&&(a=o["option.form_setting"].mapping_form_id||[]),a.forEach(function(e){(t={})["_otp_time_"+e]=null,(i=Object.keys(t)).forEach(function(e){t[e]=window.ladi(e).get_cookie()}),n.runtime.tmp["cookie_cache_otp_"+e]=t}),n.runtime.tmp["form_data_ladi_"+e.id]=n.runtime.tmp["form_data_ladi_tmp_"+e.id]}(),l(!1),B(e,o,!1,null,{isRunTracking:!1,getOtp:m,beforeRunOtp:p}),isFunctionLadiPage(i)&&i()};if(isObjectLadiPage(o)&&o["option.is_form_login"])!function(t,e){var i=t.querySelector('input[name="access_key"]');if(!isEmptyLadiPage(i)&&!isEmptyLadiPage(i.value)){for(var a=[],o=0,r=1;r<=50;r++){var c=window.ladi("_login_token_"+r).get_cookie();0==o&&isEmptyLadiPage(c)&&(o=r),a.push(c)}if(0==o){for(r=1;r<=50;r++)window.ladi("_login_token_"+r).delete_cookie();a=[],o=1}n.sendRequest("POST",n.const.API_ACCESS_KEY_LOGIN,JSON.stringify({tokens:a.removeSpace(),url:window.location.href,code:i.value.toUpperCase()}),!0,{"Content-Type":"application/json"},function(t,e,i,r){if(i.readyState==XMLHttpRequest.DONE){var c={},d=n.const.LANG.FORM_LOGIN_SEND_ERROR;try{if(200==(c=JSON.parse(t)).code){var s=a.findIndex(function(t){return t==c.data.token});-1!=s&&(o=s+1),window.ladi("_login_token_"+o).set_cookie(c.data.token,7);var u=n.getElementAHref(c.data.url,!0),l=window.location.search;return(l.startsWith("?")||l.startsWith("&"))&&(l=l.substring(1)),isEmptyLadiPage(l)||(u.search=u.search+(isEmptyLadiPage(u.search)?"?":"&")+l),void window.ladi(u.href).open_url()}d=c.message||d}catch(t){}n.showMessage(d)}})}}(e);else if(isObjectLadiPage(o)&&o["option.is_form_checkout"])s({isSendFormCheckout:!0});else if(isObjectLadiPage(o)&&isObjectLadiPage(o["option.form_setting"])&&o["option.form_setting"].is_multiple)o["option.form_setting"].is_multiple_otp?(l(!0),m(!1,function(t){if(t){var e=[];isObjectLadiPage(o["option.form_setting"])&&(e=o["option.form_setting"].mapping_form_id||[]),e.forEach(function(t){var e=document.getElementById(t);if(!isEmptyLadiPage(e)){var i=e.querySelector(".ladi-form-item .button-get-code");isEmptyLadiPage(i)||(e.setAttribute("data-start-countdown-otp",!0),i.click())}})}})):B(e,o,!1,null,{isRunTracking:!0});else{if(n.runtime.shopping_product_type==n.const.FORM_CONFIG_TYPE.ladisales&&!isNullLadiPage(n.runtime.shopping_config_checkout_id)){a=n.findAncestor(e,"ladi-popup");if(!isEmptyLadiPage(a)&&(a=n.findAncestor(a,"ladi-element"),!isEmptyLadiPage(a)&&"POPUP_CHECKOUT"==a.id))return function(t){var e=window.ladi("_cart_token").get_cookie(),a=window.ladi("_checkout_token").get_cookie();_={},g={},f=[],A=[],O=[],q(t,!1);var o=u.email,r=u.phone;if(isEmptyLadiPage(e)||isEmptyLadiPage(a))n.showMessage(n.const.LANG.FORM_INPUT_REQUIRED_ERROR);else if(isEmptyLadiPage(o)&&isEmptyLadiPage(r))n.showMessage(n.const.LANG.FORM_INPUT_REQUIRED_ERROR);else{var c=u.name,d=u.address,s=u.message,l=u.country||"";l=l.split(":")[0];var p=u.state||"";p=p.split(":")[0];var m=u.district||"";m=m.split(":")[0];var h=u.ward||"";h=h.split(":")[0];var y=u.coupon,v=n.runtime.tmp.add_to_cart_shipping_method_id,E=n.getLadiSaleCheckoutCartProducts(),L={cart_token:e,checkout_token:a,discount_code:y,customer_first_name:c,customer_email:o,customer_phone:r,customer_address:d,customer_note:s,customer_country_code:l,customer_state_id:p,customer_district_id:m,customer_ward_id:h,shipping_method_id:v,shipping_first_name:c,shipping_address:d,shipping_phone:r,shipping_email:o,shipping_country_code:l,shipping_state_id:p,shipping_district_id:m,shipping_ward_id:h,shipping_note:s,checkout_config_id:n.runtime.shopping_config_checkout_id,is_export_invoice:0,is_generate_url:!0,variants:E,source:"LADIPAGE",utm:{url_page:window.location.href}};S=n.getURLSearchParams(null,null,!1),x.forEach(function(t){L.utm[t]=isNullLadiPage(S[t])?"":S[t]}),isNullLadiPage(S[n.const.LADIFLOW_DATA_KEY_NAME])||(L.utm[n.const.LADIFLOW_DATA_KEY_NAME]=S[n.const.LADIFLOW_DATA_KEY_NAME]),n.runtime.has_popupx&&(L.utm.origin_url_page=n.runtime.tmp.popupx_origin_url),isEmptyLadiPage(i)||(L.utm[n.const.REF_NAME]=i),L.custom_fields={};var P=Object.keys(u);(P=P.except(["name","email","phone","address","country","state","district","ward","message","coupon"])).forEach(function(t){L.custom_fields[t]=u[t]}),n.sendRequest("POST",n.const.API_LADISALE_CHECKOUT_CREATE,JSON.stringify(L),!0,{"Content-Type":"application/json"},function(t,e,i){if(i.readyState==XMLHttpRequest.DONE){if(200==e)try{var a=JSON.parse(t);if(200==a.code&&isObjectLadiPage(a.data)&&!isEmptyLadiPage(a.data.url)){var o=window.ladi(a.data.url).get_url(),r=n.getElementAHref(o,!0),c=n.getURLSearchParams(r.search,null,!1);return isEmptyLadiPage(n.runtime.shopping_config_checkout_id)||(c.checkout_config_id=n.runtime.shopping_config_checkout_id),c.ladi_redirect_url=window.location.href,c=Object.keys(c).reduce(function(t,e){return t.push(e+"="+encodeURIComponent(c[e])),t},[]).join("&"),r.search=c,o=r.href,void window.ladi(o).open_url()}if(!isEmptyLadiPage(a.message))return void n.showMessage(a.message)}catch(t){}n.showMessage(n.const.LANG.REQUEST_SEND_ERROR)}})}}(e),!1}s({isFormOtp:!1})}}else{var y=r[c].querySelectorAll('[type="checkbox"]');if(y.length>0){y[0].setAttribute("required","required");for(var v=0;v<y.length;v++)y[v].removeEventListener("change",J),y[v].addEventListener("change",J);e.querySelector(".ladi-form").reportValidity()}}}return!1},W=function(t,e,i,a){var o=n.findAncestor(t.target,"ladi-form");if(!isEmptyLadiPage(o)){var r=n.findAncestor(t.target,"ladi-button");r=n.findAncestor(r||t.target,"ladi-element");var c=n.findAncestor(o,"ladi-element");if(!(isEmptyLadiPage(c)||(i=e?i:n.runtime.eventData[c.id],isEmptyLadiPage(i)||!i["option.is_buy_now"]&&!i["option.is_add_to_cart"]||isEmptyLadiPage(i["option.product_type"])||isEmptyLadiPage(i["option.product_id"])))){var d=function(){var o=n.generateVariantProduct(i,!1,null,null,null,null,!0,!0,d);if(isEmptyLadiPage(o)||isEmptyLadiPage(o.store_info)||isEmptyLadiPage(o.product))isEmptyLadiPage(n.runtime.tmp.timeout_product_info[i["option.product_type"]][i["option.product_id"]])&&n.showMessage(n.const.LANG.ADD_TO_CART_NO_PRODUCT,{name:n.getMessageNameProduct()});else{var s=-1,u=null;if(e){var l=c.querySelector('[data-variant="true"]');u=n.getProductVariantId(l,o.product),isEmptyLadiPage(u)||(s=o.product.variants.findIndex(function(t){return t.product_variant_id==u}))}else s=n.getProductVariantIndex(c.id,i);if(-1!=s){var p=o.product.variants[s].product_id;u=o.product.variants[s].product_variant_id;var m=o.product.name,_=o.product.variants[s].title,g=o.product.variants[s].price,f=o.product.variants[s].quantity,h=o.product.variants[s].quantity_stock;f=isNullLadiPage(h)?f:h;var y=isEmptyLadiPage(o.product.variants[s].src)?"":o.product.variants[s].src;y=isEmptyLadiPage(y)&&isObjectLadiPage(o.product.image)?o.product.image.src:y,isEmptyLadiPage(y)||!isStringLadiPage(y)||y.startsWith("http://")||y.startsWith("https://")||y.startsWith("//")||(y="https://"+n.const.STATIC_W_DOMAIN+"/"+y);if(0==o.product.select_many_service&&isArrayLadiPage(n.runtime.tmp.cart)&&-1!=n.runtime.tmp.cart.findIndex(function(t){return t.product_id==p&&t.product_variant_id!=u&&t.quantity>0}))n.showMessage(n.const.LANG.ADD_TO_CART_PRODUCT_ONLY_ONE,{name:n.getMessageNameProduct(o.product.variants[s])});else{var v=n.runtime.tmp.cart.findIndex(function(t){return t.product_variant_id==u}),E=!1;if(-1==v){E=!0;var L={store_id:o.store_info.id,product_id:p,product_variant_id:u,name:m,title:_,price:g,image:y,quantity:0,min_buy:o.product.variants[s].min_buy,max_buy:o.product.variants[s].max_buy,inventory_checked:o.product.variants[s].inventory_checked,available_quantity:f,currency:o.store_info.currency,product_type:o.product.variants[s].product_type,package_quantity:o.product.variants[s].package_quantity};isObjectLadiPage(L.currency)&&!isEmptyLadiPage(L.currency.code)&&(L.currency.symbol=n.formatCurrency(null,L.currency.code,!1,!0)),n.runtime.tmp.cart.push(L),v=n.runtime.tmp.cart.length-1}var P=c.querySelector('input[name="quantity"]');if(isEmptyLadiPage(P)||isEmptyLadiPage(P.value))n.showMessage(n.const.LANG.ADD_TO_CART_QUANTITY_REQUIRED);else{var w=parseInt(P.value)||0;if(w<=0)return void n.showMessage(n.const.LANG.ADD_TO_CART_QUANTITY_REQUIRED);var k=null,b=1;b=o.product.variants[s].min_buy||b;var A=o.product.variants[s].max_buy;b>n.runtime.tmp.cart[v].quantity+w&&(w=b-n.runtime.tmp.cart[v].quantity);var O=!1;if(!isEmptyLadiPage(A)&&n.runtime.tmp.cart[v].quantity+w>A&&(w=A-n.runtime.tmp.cart[v].quantity)<=0&&(O=!0,k=A),1==o.product.variants[s].inventory_checked){if(b>f)return void n.showMessage(n.const.LANG.ADD_TO_CART_NO_QUANTITY,{name:n.getMessageNameProduct(o.product.variants[s],!0)});n.runtime.tmp.cart[v].quantity+w>f&&(w=f-n.runtime.tmp.cart[v].quantity,f>0&&(O=!0,(isEmptyLadiPage(k)||k>f)&&(k=f)))}if(O||w<=0&&f>0)n.showMessage(n.const.LANG.ADD_TO_CART_MAX_QUANTITY,{max:k,name:n.getMessageNameProduct(o.product.variants[s])},function(){var e=t.target;e=n.findAncestor(e,"ladi-button"),isEmptyLadiPage(e)||(e=n.findAncestor(e,"ladi-element"));var i=n.runtime.eventData[e.id];if(!isEmptyLadiPage(i)){var a=i["option.data_event"];if(!isArrayLadiPage(a)&&(a=[],isObjectLadiPage(i["option.data_action"]))){var o=n.copy(i["option.data_action"]);o.action_type=n.const.ACTION_TYPE.action,a.push(o)}a.forEach(function(t){t.action_type==n.const.ACTION_TYPE.action&&(t.type==n.const.DATA_ACTION_TYPE.popup_cart&&window.ladi("POPUP_CART").show(),t.type==n.const.DATA_ACTION_TYPE.popup_checkout&&(n.runtime.shopping_third_party?n.getThirdPartyCheckoutUrl(!0,null,{event:{target:r}}):window.ladi("POPUP_CHECKOUT").show(!1,{event:{target:r}})))})}});else if(w>0){var T=!isEmptyLadiPage(o.product.variants[s].start_date)&&new Date(o.product.variants[s].start_date).getTime()>Date.now(),S=!isEmptyLadiPage(o.product.variants[s].end_date)&&new Date(o.product.variants[s].end_date).getTime()<Date.now();if(T)n.showMessage(n.const.LANG.ADD_TO_CART_PRODUCT_BEFORE_START_DATE,{name:n.getMessageNameProduct(o.product.variants[s])});else if(S)n.showMessage(n.const.LANG.ADD_TO_CART_PRODUCT_AFTER_END_DATE,{name:n.getMessageNameProduct(o.product.variants[s])});else{var x=function(){n.runtime.tmp.cart[v].quantity+=w;var t={product_id:p,product_variant_id:u,quantity:w};t.product_type=n.runtime.tmp.cart[v].product_type,t.package_quantity=n.runtime.tmp.cart[v].package_quantity;var e=isObjectLadiPage(n.runtime.tmp.cart[v].currency)&&!isEmptyLadiPage(n.runtime.tmp.cart[v].currency.code)?n.runtime.tmp.cart[v].currency.code:n.runtime.currency,i=n.runtime.tmp.cart[v].price;n.addCartCookie(o.store_info.id,t,function(){isFunctionLadiPage(a)&&a();var t=document.getElementsByClassName("ladi-form-remove-coupon")[0];isEmptyLadiPage(t)||t.click(),n.updateCartPromotion(),n.runEventTracking(null,{cart_quantity:w,cart_currency:e,cart_value:i,is_form:!1,is_add_to_cart:!0,is_custom:!0,event:{target:r}})},function(t){n.runtime.tmp.cart[v].quantity-=w,E&&n.runtime.tmp.cart.splice(v,1),n.showMessage(t.message)},function(){LadiPageShopping.push(function(){n.runtime.tmp.generateCart()}),LadiPageShopping.push(function(){n.changeTotalPriceCart()}),n.runtime.tmp.is_click_add_to_cart=!1,0==n.runtime.tmp.cart.length&&-1!=[n.const.FORM_CONFIG_TYPE.ladisales].indexOf(n.runtime.shopping_product_type)&&(window.ladi("_cart_token").delete_cookie(),window.ladi("_checkout_token").delete_cookie()),n.runResizeAll()})};if(isEmptyLadiPage(window.ladi("_cart_token").get_cookie()))if(n.runtime.tmp.is_click_add_to_cart){var N=function(){n.runTimeout(function(){if(n.runtime.tmp.is_click_add_to_cart)return N();d()},100)};N()}else n.runtime.tmp.is_click_add_to_cart=!0,x();else x()}}else f<=0&&n.showMessage(n.const.LANG.ADD_TO_CART_NO_QUANTITY,{name:n.getMessageNameProduct(o.product.variants[s],!0)})}}}else n.showMessage(n.const.LANG.ADD_TO_CART_PRODUCT_REQUIRED,{name:n.getMessageNameProduct(o.product.variants[s])})}};LadiPageShopping.push(function(){d()})}}},V=function(t){W(t,!1,null,function(){var e=n.findAncestor(t.target,"ladi-button");e=n.findAncestor(e||t.target,"ladi-element");var i=n.runtime.eventData[e.id];if(!isEmptyLadiPage(i)){var a=i["option.data_event"];if(!isArrayLadiPage(a)&&(a=[],isObjectLadiPage(i["option.data_action"]))){var o=n.copy(i["option.data_action"]);o.action_type=n.const.ACTION_TYPE.action,a.push(o)}a.forEach(function(t){if(t.action_type==n.const.ACTION_TYPE.action){var i=null;t.type==n.const.DATA_ACTION_TYPE.popup_cart&&(i="POPUP_CART"),t.type==n.const.DATA_ACTION_TYPE.popup_checkout&&(i="POPUP_CHECKOUT"),t.type==n.const.DATA_ACTION_TYPE.popup_checkout&&n.runtime.shopping_third_party?n.getThirdPartyCheckoutUrl(!0,null,{event:{target:e}}):isEmptyLadiPage(i)||window.ladi(i).show(!1,{event:{target:e}})}}),n.runEventTracking(e.id,{is_form:!1})}})},z=function(t){var e=n.findAncestor(t.target,"ladi-form");isEmptyLadiPage(e)||(e=n.findAncestor(e,"ladi-element"),isEmptyLadiPage(e)||window.ladi(e.id).submit())},$=function(t){var e=n.findAncestor(t.target,"ladi-form");if(!isEmptyLadiPage(e)){var i=n.findAncestor(e,"ladi-element");if(!isEmptyLadiPage(i)){n.setEventDataFormDynamic(i.id);var a=n.runtime.eventData[i.id];if(!isEmptyLadiPage(a)){var o={};if(isObjectLadiPage(a["option.form_setting"])&&a["option.form_setting"].is_multiple){if(!a["option.form_setting"].is_multiple_otp)return void B(i,a,!0,t.target.getAttribute("name"),{isRunTracking:!0});o.isFormOtp=!0,o.isCapture=!0}if(a["option.form_auto_capture"]&&!isEmptyLadiPage(a["option.form_config_id"])){var r=R(i.id,a["option.form_config_id"]);G(i,{captcha:!0},!0,r,t.target.getAttribute("name"),o)}}}}},Q={};N.forEach(function(t){Q[t]=window.ladi("_ladipage_"+t).get_cookie(),isEmptyLadiPage(Q[t])||(Base64.encode(Base64.decode(Q[t]))==Q[t]?Q[t]=Base64.decode(Q[t]):Q[t]=""),isEmptyLadiPage(Q[t])&&n.removeCookieDomains("_ladipage_"+t),isEmptyLadiPage(e[t])||(Q[t]=e[t])}),a=n.runtime.tmp.convertFormDataObjectCountry(Q);var X=0,Z=!1,tt=function(t){for(var e=c[X].querySelectorAll('.ladi-element .ladi-form-item-container [name="'+t+'"]'),i=null,o=0;o<e.length;o++){var r=Q[t];if(!isEmptyLadiPage(r)&&"none"!=getComputedStyle(e[o]).display)if("true"!=e[o].getAttribute("data-is-select-country")&&(r=a[t]),"SELECT"==e[o].tagName)e[o].querySelectorAll('option[value="'+r+'"]').length>0&&(e[o].value=r,Z&&n.fireEvent(e[o],"change"));else{if("country"==t&&"true"==e[o].getAttribute("data-is-select-country"))continue;"INPUT"==e[o].tagName&&"true"==e[o].getAttribute("data-is-select-country")&&2==(i=r.split(":")).length&&(r=i[1]),e[o].value=r,Z&&n.fireEvent(e[o],"change")}}},et=function(t){t.target.type="date",t.target.focus()},it=function(t){isEmptyLadiPage(t.target.value)&&(t.target.type="text")};for(X=0;X<c.length;X++){c[X].onsubmit=K;for(var at=n.findAncestor(c[X],"ladi-element"),nt=c[X].getElementsByClassName("ladi-button"),ot=0;ot<nt.length;ot++){var rt=c[X].getElementsByClassName("ladi-button")[ot];if(!isEmptyLadiPage(rt)){var ct=n.findAncestor(rt,"ladi-element");isEmptyLadiPage(at)||isEmptyLadiPage(n.runtime.eventData[at.id])||!n.runtime.eventData[at.id]["option.is_add_to_cart"]?ct.addEventListener("click",z):(ct.setAttribute("data-click",!1),ct.addEventListener("click",V))}}var dt=c[X].querySelector('[data-is-select-country="true"][name="country"]');if(!isEmptyLadiPage(dt)&&"true"==dt.getAttribute("data-no-ward")){var st=c[X].querySelector('[data-is-select-country="true"][name="ward"]');isEmptyLadiPage(st)||st.removeAttribute("required")}for(var ut=c[X].querySelectorAll('input[data-type="date"]'),lt=0;lt<ut.length;lt++)isEmptyLadiPage(ut[lt].getAttribute("placeholder"))||(ut[lt].setAttribute("data-event",!0),n.runtime.isDesktop||n.runtime.isBrowserDesktop?(ut[lt].setAttribute("type","text"),ut[lt].addEventListener("focus",et),ut[lt].addEventListener("blur",it)):ut[lt].value=(new Date).toISOString().substr(0,10));var pt=c[X].querySelectorAll("[tabindex]"),mt=0,_t=0;for(lt=0;lt<pt.length;lt++)(_t=parseInt(pt[lt].getAttribute("tabindex"))||0)>mt&&(mt=_t),pt[lt].setAttribute("tabindex",n.runtime.tabindexForm+_t);for(pt=c[X].querySelectorAll("[data-tabindex]"),lt=0;lt<pt.length;lt++)(_t=parseInt(pt[lt].getAttribute("data-tabindex"))||0)>mt&&(mt=_t),pt[lt].setAttribute("data-tabindex",n.runtime.tabindexForm+_t);n.runtime.tabindexForm+=mt;for(var gt=0;gt<C.length;gt++){var ft=c[X].querySelector('.ladi-element .ladi-form-item-container input[name="'+C[gt]+'"]');isEmptyLadiPage(ft)||ft.addEventListener("focusout",$)}}n.runOptionFormCheckout();var ht=function(t,e){for(Z=e,X=0;X<c.length;X++){var i=n.findAncestor(c[X],"ladi-element");!isEmptyLadiPage(n.runtime.eventData[i.id])&&n.runtime.eventData[i.id]["option.form_auto_complete"]&&t.forEach(tt)}};ht(n.copy(N).except(n.runtime.list_set_value_name_country));LadiPageLocation.push(function(){var t="",e="",i="",a="",o=null,r=function(t,e){var i=String(o[t].name),a=String(o[e].name);try{return i.localeCompare(a)}catch(t){}return i==a?0:i>a?1:-1},d=function(i){var a=window.LadiLocation[e];if(isObjectLadiPage(a)){var n=a.data[i];isEmptyLadiPage(n)||(t+='<option value="'+n.id+":"+n.name+'">'+n.name+"</option>")}},s=function(t){var e=window.LadiLocation[t.target.getAttribute("data-country")];if(isObjectLadiPage(e)){var a=e.data[t.target.value.split(":")[0]];if(i="",!isEmptyLadiPage(a)&&isObjectLadiPage(a.data)){var c=Object.keys(a.data);o=a.data,c.sort(r),c.forEach(function(t){var e=a.data[t];i+='<option value="'+e.id+":"+e.name+'">'+e.name+"</option>"})}var d=n.findAncestor(t.target,"ladi-element");if(!isEmptyLadiPage(d)){var s=d.querySelector('[name="district"]');isEmptyLadiPage(s)||"SELECT"==s.tagName&&(s.setAttribute("data-selected",""),s.innerHTML=s.querySelector("option").outerHTML+i);var u=d.querySelector('[name="ward"]');isEmptyLadiPage(u)||"SELECT"==u.tagName&&(u.setAttribute("data-selected",""),u.innerHTML=u.querySelector("option").outerHTML),LadiPageShopping.push(function(){n.reloadFeeShipping({target:u})})}}},u=function(t){var e=n.findAncestor(t.target,"ladi-element");if(!isEmptyLadiPage(e)){var i=e.querySelector('[name="ward"]');if(!isEmptyLadiPage(i)){a="";var c=e.querySelector('select[name="state"]');if(!isEmptyLadiPage(c)){var d=c.getAttribute("data-selected");if(!isEmptyLadiPage(d)){d=d.split(":")[0];var s=window.LadiLocation[c.getAttribute("data-country")];if(isObjectLadiPage(s)){var u=s.data[d];if(!isEmptyLadiPage(u)&&isObjectLadiPage(u.data)){var l=u.data[t.target.value.split(":")[0]];if(!isEmptyLadiPage(l)){var p=Object.keys(l.data);o=l.data,p.sort(r),p.forEach(function(t){var e=l.data[t];a+='<option value="'+e.id+":"+e.name+'">'+e.name+"</option>"})}}}}}"SELECT"==i.tagName&&(i.setAttribute("data-selected",""),i.innerHTML=i.querySelector("option").outerHTML+a);var m=e.querySelector('[name="district"]');isEmptyLadiPage(m)||"SELECT"!=m.tagName||LadiPageShopping.push(function(){n.reloadFeeShipping({target:i})})}}},l=function(t){var e=n.findAncestor(t.target,"ladi-element");if(!isEmptyLadiPage(e)){var i=e.querySelector('[name="ward"]');isEmptyLadiPage(i)||"SELECT"!=i.tagName||LadiPageShopping.push(function(){n.reloadFeeShipping()})}};for(X=0;X<c.length;X++){var p=c[X].querySelectorAll('.ladi-element .ladi-form-item-container [name="state"]'),m=0,_=null;for(m=0;m<p.length;m++)if(_=n.findAncestor(p[m],"ladi-element"),!isEmptyLadiPage(_)&&(e=n.runtime.eventData[_.id]["option.input_country"],!isEmptyLadiPage(e)&&(t="",e=e.split(":")[0],isObjectLadiPage(window.LadiLocation[e])))){var g=window.LadiLocation[e].data,f=Object.keys(g);o=g,f.sort(r),isArrayLadiPage(n.runtime.country_state_sort[e])&&(f=f.except(n.runtime.country_state_sort[e]),f=n.runtime.country_state_sort[e].concat(f)),f.forEach(d),p[m].setAttribute("data-country",e),p[m].innerHTML=p[m].querySelector("option").outerHTML+t,p[m].removeEventListener("change",s),p[m].addEventListener("change",s)}var h=c[X].querySelectorAll('.ladi-element .ladi-form-item-container [name="district"]');for(m=0;m<h.length;m++)h[m].removeEventListener("change",u),h[m].addEventListener("change",u);var y=c[X].querySelectorAll('.ladi-element .ladi-form-item-container [name="ward"]');for(m=0;m<y.length;m++)y[m].removeEventListener("change",l),y[m].addEventListener("change",l)}}),LadiPageLocation.push(function(){ht(D,!0)}),n.runtime.tmp.buttonAddToCartClick=W,n.runtime.tmp.formMappingFunnelX=function(t,e,i,a){var o=n.runtime.eventData[t],r=document.getElementById(t);if(!isEmptyLadiPage(r)){var c=!1;if(isObjectLadiPage(o)){var d=isObjectLadiPage(o["option.form_setting"])&&o["option.form_setting"].is_multiple;(o["option.form_auto_funnel"]||d)&&(c=!0)}(a||c)&&Object.keys(i).forEach(function(t){var e=r.querySelector('.ladi-form > .ladi-element [name="'+t+'"]');isEmptyLadiPage(e)||(e=n.findAncestor(e,"ladi-element"),window.ladi(e.id).value(i[t]))})}Object.keys(i).forEach(function(t){n.setDataReplaceStr(t,i[t])});var s=null,u=n.findAncestor(r,["ladi-popup","ladi-element"]);isEmptyLadiPage(u)||(s=u.id),n.setDataReplaceElement(!1,!1,null,s)}},LadiPageScriptV2.prototype.setEventDataFormDynamic=function(t){var e=this,i=function(){var t=e.runtime.tmp.form_data_dynamic;if(isNullLadiPage(t))try{var i=document.getElementById("script_form_data_dynamic");isEmptyLadiPage(i)||(t=JSON.parse(i.innerHTML),t=e.deOptimizeEventData(t,LadiPageScript.const.OPTIMIZE_EVENT_DATA_KEY_LIST,"OPTIMIZE_EVENT_DATA_KEY_LIST"),e.runtime.tmp.form_data_dynamic=t)}catch(t){}return t}();if(isArrayLadiPage(i)&&i.length>0){var a="event_data_"+t;isNullLadiPage(e.runtime.tmp[a])&&isObjectLadiPage(e.runtime.eventData[t])&&(e.runtime.tmp[a]=e.copy(e.runtime.eventData[t]));var n=isObjectLadiPage(e.runtime.tmp[a])?e.copy(e.runtime.tmp[a]):e.runtime.eventData[t],o=!0,r=function(t,e,i){var a=!1;"NOT_CONTAINS"!=e&&"NOT_STARTS_WITH"!=e&&"NOT_ENDS_WITH"!=e&&"!="!=e&&"NOT_IN"!=e||(a=!0);var n=isEmptyLadiPage(i)?"":i;n=(n=isStringLadiPage(n)?n:String(n)).toLowerCase();for(var o=0==i?0:parseFloatLadiPage(i)||null,r=0;r<t.length;r++){var c=isEmptyLadiPage(t[r])?"":t[r];c=(c=isStringLadiPage(c)?c:String(c)).toLowerCase();var d=0==t[r]?0:parseFloatLadiPage(t[r])||null;if("CONTAINS"==e&&-1!=n.indexOf(c)){a=!0;break}if("NOT_CONTAINS"==e&&-1!=n.indexOf(c)){a=!1;break}if("STARTS_WITH"==e&&n.startsWith(c)){a=!0;break}if("NOT_STARTS_WITH"==e&&n.startsWith(c)){a=!1;break}if("ENDS_WITH"==e&&n.endsWith(c)){a=!0;break}if("NOT_ENDS_WITH"==e&&n.endsWith(c)){a=!1;break}if(("="==e||"IN"==e)&&n==c){a=!0;break}if(("!="==e||"NOT_IN"==e)&&n==c){a=!1;break}if(!isEmptyLadiPage(d)&&!isEmptyLadiPage(o)){if(">"==e&&o>d){a=!0;break}if(">="==e&&o>=d){a=!0;break}if("<"==e&&o<d){a=!0;break}if("<="==e&&o<=d){a=!0;break}}}return a},c=function(i){if(o)try{var a=null;"FORM_ITEM"==i.type&&("id"==i.form_item_type&&(a=document.querySelector("#"+t+' > .ladi-form > .ladi-element[id="'+i.form_item_value+'"]')),"name"==i.form_item_type&&(a=document.querySelector("#"+t+' > .ladi-form > .ladi-element [name="'+i.form_item_value+'"]'),a=e.findAncestor(a,"ladi-element")),o=!isEmptyLadiPage(a)&&r(i.value,i.operator,window.ladi(a.id).value())),"FORM"==i.type&&(o=r(i.value,i.operator,t))}catch(t){o=!1}};i.forEach(function(t){isObjectLadiPage(t.form_data)&&(o=!0,isArrayLadiPage(t.conditions)&&t.conditions.forEach(c),o&&(n=e.copy(t.form_data)))}),e.runtime.eventData[t]=n}},LadiPageScriptV2.prototype.setInputOtp=function(){for(var t=this,e=document.querySelectorAll(".ladi-form .ladi-element .ladi-form-otp"),i=function(e,a){var n=t.findAncestor(a,"ladi-form");if(!isEmptyLadiPage(n)&&(n=t.findAncestor(n,"ladi-element"),!isEmptyLadiPage(n))){var o="_otp_time_"+n.id,r=window.ladi(o).get_cookie(),c=t.runtime.tmp["cookie_cache_otp_"+n.id];isEmptyLadiPage(r)&&isObjectLadiPage(c)&&!isEmptyLadiPage(c[o])&&(r=c[o]);var d=(r=parseFloatLadiPage(r)||0)+t.runtime.time_otp-Date.now();d=d<t.runtime.time_otp?d:0,r<=0||d<=0?function(t){t.classList.add("otp-resend"),t.classList.remove("otp-countdown"),t.removeAttribute("data-countdown-time")}(e):(d=Math.ceil(d/1e3),e.classList.remove("otp-resend"),e.classList.add("otp-countdown"),e.setAttribute("data-countdown-time",d),t.runTimeout(function(){i(e,a)},1e3))}},a=function(e){var a=t.findAncestor(e.target,"ladi-form");if(!isEmptyLadiPage(a)&&(a=t.findAncestor(a,"ladi-element"),!isEmptyLadiPage(a))){var n="_otp_time_"+a.id,o=!1,r=t.runtime.tmp["cookie_cache_otp_"+a.id],c=function(){a.removeAttribute("data-start-countdown-otp");var c=new Date;c.setTime(c.getTime()+t.runtime.time_otp),o?(r[n]=Date.now(),t.runtime.tmp["cookie_cache_otp_"+a.id]=r):window.ladi(n).set_cookie(Date.now(),c);var d=t.findAncestor(e.target,"ladi-form-item");t.runTimeout(function(){i(d,e.target)},1)};if("true"!=a.getAttribute("data-start-countdown-otp")){var d=window.ladi(n).get_cookie();isEmptyLadiPage(d)&&isObjectLadiPage(r)&&!isEmptyLadiPage(r[n])&&(d=r[n],o=!0);var s=(d=parseFloatLadiPage(d)||0)+t.runtime.time_otp-Date.now();s=s<t.runtime.time_otp?s:0,(d<=0||s<=0)&&"true"!=e.target.getAttribute("data-click")&&isFunctionLadiPage(t.runtime.func_get_code_otp[a.id])&&(t.removeTimeout(t.runtime.tmp.timeout_is_wait_popup_id),t.runtime.tmp.is_wait_popup=!0,t.showLoadingBlur(),e.target.setAttribute("data-click",!0),t.runtime.func_get_code_otp[a.id](!0,function(i){e.target.removeAttribute("data-click"),t.hideLoadingBlur(),i&&c(),t.runtime.tmp.timeout_is_wait_popup_id=t.runTimeout(function(){delete t.runtime.tmp.is_wait_popup},200)}))}else c()}},n=0;n<e.length;n++){var o=e[n],r=t.findAncestor(o,"ladi-form-item");if(!isEmptyLadiPage(r)){r.classList.add("overflow-hidden");var c=r.getElementsByClassName("button-get-code")[0];isEmptyLadiPage(c)&&((c=document.createElement("div")).className="button-get-code",c.innerHTML=t.const.LANG.GET_CODE_BUTTON_TEXT,c.addEventListener("click",a),r.appendChild(c)),c.classList.add("hide-visibility"),o.style.setProperty("padding-right",c.clientWidth+5+"px"),c.classList.remove("hide-visibility"),i(r,c)}}},LadiPageScriptV2.prototype.setInputFile=function(){for(var t=this,e=document.querySelectorAll(".ladi-form .ladi-element .ladi-form-control-file"),i=function(e){var i=e.target,a=i.getAttribute("data-click-id")||t.randomId();i.setAttribute("data-click-id",a);var n=document.getElementById("ladi-input-file");if(isEmptyLadiPage(n)){(n=document.createElement("input")).id="ladi-input-file";var o=t.findAncestor(i,"ladi-element");!isEmptyLadiPage(o)&&o.classList.contains("accept-all")||n.setAttribute("accept",".jpg, .jpeg, .png, .gif, .svg, .ico, .mp3, .mp4, .ttf, .otf, .woff2, .txt, .doc, .docx, .xls, .xlsx, .pdf"),n.setAttribute("style","position: absolute; top: 0; left: 0; visibility: hidden;"),n.multiple=!0,n.type="file",document.body.appendChild(n)}n.setAttribute("data-file-click-id",a),"true"!=n.getAttribute("data-event")&&(n.setAttribute("data-event",!0),n.addEventListener("change",function(e){!function(e,i,a){if(i.length>t.const.FORM_UPLOAD_FILE_LENGTH)t.showMessage(t.const.LANG.FORM_UPLOAD_FILE_MAX_LENGTH_ERROR,{max_length:t.const.FORM_UPLOAD_FILE_LENGTH});else{for(var n=new FormData,o=0,r=0;r<i.length;r++)o+=i[r].size,n.append("file[]",i[r]);if(o>1024*t.const.FORM_UPLOAD_FILE_SIZE*1024)t.showMessage(t.const.LANG.FORM_UPLOAD_FILE_MAX_SIZE_ERROR,{max_size:t.const.FORM_UPLOAD_FILE_SIZE});else{var c={ladipage_id:t.runtime.ladipage_id,lang:t.runtime.lang};n.append("json_data",JSON.stringify(c)),t.showLoadingBlur(),t.sendRequest("POST",t.const.API_FILE_UPLOAD,n,!0,null,function(i,a,n){if(n.readyState==XMLHttpRequest.DONE){if(t.hideLoadingBlur(),200==a)try{var o=JSON.parse(i);if(200==o.code){var r=[],c=[];return o.data.success.forEach(function(t){r.push(t.name),c.push({id:t._id,path:t.path,name:t.name})}),e.value=r.length>0?"["+r.join(", ")+"]":"",void e.setAttribute("data-path-file",JSON.stringify(c))}if(!isEmptyLadiPage(o.message))return void t.showMessage(o.message)}catch(t){}t.showMessage(t.const.LANG.REQUEST_SEND_ERROR)}}),isFunctionLadiPage(a)&&a()}}}(i=document.querySelector('[data-click-id="'+e.target.getAttribute("data-file-click-id")+'"]'),e.target.files,function(){e.target.value=null})})),n.click()},a=0;a<e.length;a++){var n=e[a];n.readOnly=!0,n.style.setProperty("cursor","pointer"),n.addEventListener("click",i)}},LadiPageScriptV2.prototype.runFormItem=function(t,e,i){var a=this;if("form_item"==e){var n=null,o=null;if((i==a.const.INPUT_TYPE.select||i==a.const.INPUT_TYPE.select_multiple)&&(n=document.getElementById(t),!isEmptyLadiPage(n)))for(var r=n.getElementsByClassName("ladi-form-control"),c=0;c<r.length;c++)r[c].addEventListener("change",function(t){t.target.setAttribute("data-selected",t.target.value)});if(i==a.const.INPUT_TYPE.radio||i==a.const.INPUT_TYPE.checkbox){n=document.getElementById(t);var d=function(t){t.stopPropagation();var e=a.findAncestor(t.target,"ladi-form-checkbox-item");if(!isEmptyLadiPage(e)){if(i==a.const.INPUT_TYPE.radio){var n=a.findAncestor(e,"ladi-form-checkbox");if(!isEmptyLadiPage(n))for(var o=n.querySelectorAll(".ladi-form-checkbox-item span"),r=0;r<o.length;r++)o[r].setAttribute("data-checked",!1)}e.getElementsByTagName("span")[0].setAttribute("data-checked",t.target.checked)}a.runFormItemOtherChange(e)},s=function(t){t.stopPropagation();var e=a.findAncestor(t.target,"ladi-form-checkbox-item");isEmptyLadiPage(e)||e.getElementsByTagName("input")[0].click()};if(!isEmptyLadiPage(n)){o=n.getElementsByClassName("ladi-form-checkbox-item");for(var u=0;u<o.length;u++){var l=o[u].getElementsByTagName("input")[0];o[u].getElementsByTagName("span")[0].addEventListener("click",s),l.addEventListener("change",d)}a.runFormItemOtherChange(o[0])}}}},LadiPageScriptV2.prototype.runFormData=function(t){isFunctionLadiPage(t)&&t()},function(){var t=window.LadiPageFormData||[];window.LadiPageFormData={},window.LadiPageFormData.push=function(t){LadiPageScript.runFormData(t)},t.forEach(function(t){window.LadiPageFormData.push(t)})}();